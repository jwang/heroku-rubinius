<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Module: EventMachine</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="module">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./lib/evma/callback_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/evma/callback.rb">lib/evma/callback.rb</a></li>
					
						<li><a href="./lib/em/callback_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/callback.rb">lib/em/callback.rb</a></li>
					
						<li><a href="./lib/em/channel_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/channel.rb">lib/em/channel.rb</a></li>
					
						<li><a href="./lib/em/connection_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/connection.rb">lib/em/connection.rb</a></li>
					
						<li><a href="./lib/em/deferrable_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/deferrable.rb">lib/em/deferrable.rb</a></li>
					
						<li><a href="./lib/em/file_watch_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/file_watch.rb">lib/em/file_watch.rb</a></li>
					
						<li><a href="./lib/em/future_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/future.rb">lib/em/future.rb</a></li>
					
						<li><a href="./lib/em/process_watch_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/process_watch.rb">lib/em/process_watch.rb</a></li>
					
						<li><a href="./lib/em/processes_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/processes.rb">lib/em/processes.rb</a></li>
					
						<li><a href="./lib/em/protocols/header_and_content_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/header_and_content.rb">lib/em/protocols/header_and_content.rb</a></li>
					
						<li><a href="./lib/em/protocols/httpclient_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/httpclient.rb">lib/em/protocols/httpclient.rb</a></li>
					
						<li><a href="./lib/em/protocols/httpclient2_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/httpclient2.rb">lib/em/protocols/httpclient2.rb</a></li>
					
						<li><a href="./lib/em/protocols/line_and_text_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/line_and_text.rb">lib/em/protocols/line_and_text.rb</a></li>
					
						<li><a href="./lib/em/protocols/linetext2_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/linetext2.rb">lib/em/protocols/linetext2.rb</a></li>
					
						<li><a href="./lib/em/protocols/memcache_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/memcache.rb">lib/em/protocols/memcache.rb</a></li>
					
						<li><a href="./lib/em/protocols/object_protocol_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/object_protocol.rb">lib/em/protocols/object_protocol.rb</a></li>
					
						<li><a href="./lib/em/protocols/postgres3_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/postgres3.rb">lib/em/protocols/postgres3.rb</a></li>
					
						<li><a href="./lib/em/protocols/saslauth_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/saslauth.rb">lib/em/protocols/saslauth.rb</a></li>
					
						<li><a href="./lib/em/protocols/smtpclient_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/smtpclient.rb">lib/em/protocols/smtpclient.rb</a></li>
					
						<li><a href="./lib/em/protocols/smtpserver_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/smtpserver.rb">lib/em/protocols/smtpserver.rb</a></li>
					
						<li><a href="./lib/em/protocols/socks4_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/socks4.rb">lib/em/protocols/socks4.rb</a></li>
					
						<li><a href="./lib/em/protocols/stomp_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/stomp.rb">lib/em/protocols/stomp.rb</a></li>
					
						<li><a href="./lib/em/protocols/tcptest_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols/tcptest.rb">lib/em/protocols/tcptest.rb</a></li>
					
						<li><a href="./lib/em/protocols_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/protocols.rb">lib/em/protocols.rb</a></li>
					
						<li><a href="./lib/em/queue_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/queue.rb">lib/em/queue.rb</a></li>
					
						<li><a href="./lib/em/spawnable_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/spawnable.rb">lib/em/spawnable.rb</a></li>
					
						<li><a href="./lib/em/streamer_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/streamer.rb">lib/em/streamer.rb</a></li>
					
						<li><a href="./lib/em/timers_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/timers.rb">lib/em/timers.rb</a></li>
					
						<li><a href="./lib/em/version_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/em/version.rb">lib/em/version.rb</a></li>
					
						<li><a href="./lib/eventmachine_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/eventmachine.rb">lib/eventmachine.rb</a></li>
					
						<li><a href="./lib/jeventmachine_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/jeventmachine.rb">lib/jeventmachine.rb</a></li>
					
						<li><a href="./lib/pr_eventmachine_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/pr_eventmachine.rb">lib/pr_eventmachine.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			

			<!-- Namespace Contents -->
			
			<div id="namespace-list-section" class="section">
				<h3 class="section-header">Namespace</h3>
				<ul class="link-list">
					
					<li><span class="type">MODULE</span> <a href="EventMachine/Deferrable.html">EventMachine::Deferrable</a></li>
					
					<li><span class="type">MODULE</span> <a href="EventMachine/Protocols.html">EventMachine::Protocols</a></li>
					
					<li><span class="type">MODULE</span> <a href="EventMachine/UuidGenerator.html">EventMachine::UuidGenerator</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Channel.html">EventMachine::Channel</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Connection.html">EventMachine::Connection</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/ConnectionNotBound.html">EventMachine::ConnectionNotBound</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/DatagramObject.html">EventMachine::DatagramObject</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/DefaultDeferrable.html">EventMachine::DefaultDeferrable</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/DeferrableChildProcess.html">EventMachine::DeferrableChildProcess</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Error.html">EventMachine::Error</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaKeyboard.html">EventMachine::EvmaKeyboard</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaTCPClient.html">EventMachine::EvmaTCPClient</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaTCPServer.html">EventMachine::EvmaTCPServer</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaUDPSocket.html">EventMachine::EvmaUDPSocket</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaUNIXClient.html">EventMachine::EvmaUNIXClient</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/EvmaUNIXServer.html">EventMachine::EvmaUNIXServer</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/FileNotFoundException.html">EventMachine::FileNotFoundException</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/FileStreamer.html">EventMachine::FileStreamer</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/FileWatch.html">EventMachine::FileWatch</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/JEM.html">EventMachine::JEM</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/LoopbreakReader.html">EventMachine::LoopbreakReader</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/PeriodicTimer.html">EventMachine::PeriodicTimer</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/ProcessWatch.html">EventMachine::ProcessWatch</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Queue.html">EventMachine::Queue</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Reactor.html">EventMachine::Reactor</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Selectable.html">EventMachine::Selectable</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/SpawnedProcess.html">EventMachine::SpawnedProcess</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/StreamObject.html">EventMachine::StreamObject</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/SystemCmd.html">EventMachine::SystemCmd</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Timer.html">EventMachine::Timer</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/UnknownTimerFired.html">EventMachine::UnknownTimerFired</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/Unsupported.html">EventMachine::Unsupported</a></li>
					
					<li><span class="type">CLASS</span> <a href="EventMachine/YieldBlockFromSpawnedProcess.html">EventMachine::YieldBlockFromSpawnedProcess</a></li>
					
				</ul>
			</div>
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#M000024">::Callback</a></li>
					
					<li><a href="#M000317">::add_oneshot_timer</a></li>
					
					<li><a href="#M000277">::add_oneshot_timer</a></li>
					
					<li><a href="#M000235">::add_periodic_timer</a></li>
					
					<li><a href="#M000234">::add_timer</a></li>
					
					<li><a href="#M000244">::attach</a></li>
					
					<li><a href="#M000307">::attach_fd</a></li>
					
					<li><a href="#M000242">::bind_connect</a></li>
					
					<li><a href="#M000322">::bind_connect_server</a></li>
					
					<li><a href="#M000286">::bind_connect_server</a></li>
					
					<li><a href="#M000236">::cancel_timer</a></li>
					
					<li><a href="#M000287">::close_connection</a></li>
					
					<li><a href="#M000324">::close_connection</a></li>
					
					<li><a href="#M000241">::connect</a></li>
					
					<li><a href="#M000321">::connect_server</a></li>
					
					<li><a href="#M000285">::connect_server</a></li>
					
					<li><a href="#M000247">::connect_unix_domain</a></li>
					
					<li><a href="#M000328">::connect_unix_server</a></li>
					
					<li><a href="#M000252">::connection_count</a></li>
					
					<li><a href="#M000254">::defer</a></li>
					
					<li><a href="#M000308">::detach_fd</a></li>
					
					<li><a href="#M000266">::disable_proxy</a></li>
					
					<li><a href="#M000265">::enable_proxy</a></li>
					
					<li><a href="#M000293">::epoll</a></li>
					
					<li><a href="#M000334">::epoll</a></li>
					
					<li><a href="#M000294">::epoll=</a></li>
					
					<li><a href="#M000297">::epoll?</a></li>
					
					<li><a href="#M000264">::error_handler</a></li>
					
					<li><a href="#M000000">::event_callback</a></li>
					
					<li><a href="#M000233">::fork_reactor</a></li>
					
					<li><a href="#M000313">::get_connection_count</a></li>
					
					<li><a href="#M000304">::get_max_timer_count</a></li>
					
					<li><a href="#M000251">::get_max_timers</a></li>
					
					<li><a href="#M000339">::get_outbound_data_size</a></li>
					
					<li><a href="#M000306">::get_peername</a></li>
					
					<li><a href="#M000330">::get_peername</a></li>
					
					<li><a href="#M000267">::heartbeat_interval</a></li>
					
					<li><a href="#M000268">::heartbeat_interval=</a></li>
					
					<li><a href="#M000316">::initialize_event_machine</a></li>
					
					<li><a href="#M000275">::initialize_event_machine</a></li>
					
					<li><a href="#M000301">::invoke_popen</a></li>
					
					<li><a href="#M000311">::is_notify_readable</a></li>
					
					<li><a href="#M000312">::is_notify_writable</a></li>
					
					<li><a href="#M000271">::klass_from_handler</a></li>
					
					<li><a href="#M000295">::kqueue</a></li>
					
					<li><a href="#M000296">::kqueue=</a></li>
					
					<li><a href="#M000298">::kqueue?</a></li>
					
					<li><a href="#M000305">::library_type</a></li>
					
					<li><a href="#M000315">::library_type</a></li>
					
					<li><a href="#M000256">::next_tick</a></li>
					
					<li><a href="#M000248">::open_datagram_socket</a></li>
					
					<li><a href="#M000261">::open_keyboard</a></li>
					
					<li><a href="#M000300">::open_udp_socket</a></li>
					
					<li><a href="#M000331">::open_udp_socket</a></li>
					
					<li><a href="#M000259">::popen</a></li>
					
					<li><a href="#M000260">::reactor_running?</a></li>
					
					<li><a href="#M000231">::reactor_thread?</a></li>
					
					<li><a href="#M000340">::read_keyboard</a></li>
					
					<li><a href="#M000302">::read_keyboard</a></li>
					
					<li><a href="#M000276">::release_machine</a></li>
					
					<li><a href="#M000319">::release_machine</a></li>
					
					<li><a href="#M000229">::run</a></li>
					
					<li><a href="#M000230">::run_block</a></li>
					
					<li><a href="#M000318">::run_machine</a></li>
					
					<li><a href="#M000278">::run_machine</a></li>
					
					<li><a href="#M000232">::schedule</a></li>
					
					<li><a href="#M000323">::send_data</a></li>
					
					<li><a href="#M000283">::send_data</a></li>
					
					<li><a href="#M000284">::send_datagram</a></li>
					
					<li><a href="#M000332">::send_datagram</a></li>
					
					<li><a href="#M000338">::send_file_data</a></li>
					
					<li><a href="#M000288">::set_comm_inactivity_timeout</a></li>
					
					<li><a href="#M000341">::set_comm_inactivity_timeout</a></li>
					
					<li><a href="#M000258">::set_descriptor_table_size</a></li>
					
					<li><a href="#M000257">::set_effective_user</a></li>
					
					<li><a href="#M000303">::set_max_timer_count</a></li>
					
					<li><a href="#M000337">::set_max_timer_count</a></li>
					
					<li><a href="#M000250">::set_max_timers</a></li>
					
					<li><a href="#M000309">::set_notify_readable</a></li>
					
					<li><a href="#M000310">::set_notify_writable</a></li>
					
					<li><a href="#M000249">::set_quantum</a></li>
					
					<li><a href="#M000299">::set_rlimit_nofile</a></li>
					
					<li><a href="#M000336">::set_rlimit_nofile</a></li>
					
					<li><a href="#M000333">::set_timer_quantum</a></li>
					
					<li><a href="#M000292">::set_timer_quantum</a></li>
					
					<li><a href="#M000329">::signal_loopbreak</a></li>
					
					<li><a href="#M000291">::signal_loopbreak</a></li>
					
					<li><a href="#M000215">::spawn</a></li>
					
					<li><a href="#M000290">::ssl?</a></li>
					
					<li><a href="#M000335">::ssl?</a></li>
					
					<li><a href="#M000238">::start_server</a></li>
					
					<li><a href="#M000280">::start_tcp_server</a></li>
					
					<li><a href="#M000325">::start_tcp_server</a></li>
					
					<li><a href="#M000289">::start_tls</a></li>
					
					<li><a href="#M000240">::start_unix_domain_server</a></li>
					
					<li><a href="#M000327">::start_unix_server</a></li>
					
					<li><a href="#M000282">::start_unix_server</a></li>
					
					<li><a href="#M000279">::stop</a></li>
					
					<li><a href="#M000320">::stop</a></li>
					
					<li><a href="#M000237">::stop_event_loop</a></li>
					
					<li><a href="#M000239">::stop_server</a></li>
					
					<li><a href="#M000281">::stop_tcp_server</a></li>
					
					<li><a href="#M000326">::stop_tcp_server</a></li>
					
					<li><a href="#M000097">::system</a></li>
					
					<li><a href="#M000243">::watch</a></li>
					
					<li><a href="#M000262">::watch_file</a></li>
					
					<li><a href="#M000263">::watch_process</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./EventMachine.html">EventMachine</a></li>
				
					<li><a href="./EventMachine.html">EventMachine</a></li>
				
					<li><a href="./EventMachine/Channel.html">EventMachine::Channel</a></li>
				
					<li><a href="./EventMachine/Connection.html">EventMachine::Connection</a></li>
				
					<li><a href="./EventMachine/ConnectionNotBound.html">EventMachine::ConnectionNotBound</a></li>
				
					<li><a href="./EventMachine/DatagramObject.html">EventMachine::DatagramObject</a></li>
				
					<li><a href="./EventMachine/DefaultDeferrable.html">EventMachine::DefaultDeferrable</a></li>
				
					<li><a href="./EventMachine/Deferrable.html">EventMachine::Deferrable</a></li>
				
					<li><a href="./EventMachine/DeferrableChildProcess.html">EventMachine::DeferrableChildProcess</a></li>
				
					<li><a href="./EventMachine/Error.html">EventMachine::Error</a></li>
				
					<li><a href="./EventMachine/EvmaKeyboard.html">EventMachine::EvmaKeyboard</a></li>
				
					<li><a href="./EventMachine/EvmaTCPClient.html">EventMachine::EvmaTCPClient</a></li>
				
					<li><a href="./EventMachine/EvmaTCPServer.html">EventMachine::EvmaTCPServer</a></li>
				
					<li><a href="./EventMachine/EvmaUDPSocket.html">EventMachine::EvmaUDPSocket</a></li>
				
					<li><a href="./EventMachine/EvmaUNIXClient.html">EventMachine::EvmaUNIXClient</a></li>
				
					<li><a href="./EventMachine/EvmaUNIXServer.html">EventMachine::EvmaUNIXServer</a></li>
				
					<li><a href="./EventMachine/FileStreamer.html">EventMachine::FileStreamer</a></li>
				
					<li><a href="./EventMachine/FileWatch.html">EventMachine::FileWatch</a></li>
				
					<li><a href="./EventMachine/JEM.html">EventMachine::JEM</a></li>
				
					<li><a href="./EventMachine/LoopbreakReader.html">EventMachine::LoopbreakReader</a></li>
				
					<li><a href="./EventMachine/PeriodicTimer.html">EventMachine::PeriodicTimer</a></li>
				
					<li><a href="./EventMachine/ProcessWatch.html">EventMachine::ProcessWatch</a></li>
				
					<li><a href="./EventMachine/Protocols.html">EventMachine::Protocols</a></li>
				
					<li><a href="./EventMachine/Protocols.html">EventMachine::Protocols</a></li>
				
					<li><a href="./EventMachine/Protocols/HeaderAndContentProtocol.html">EventMachine::Protocols::HeaderAndContentProtocol</a></li>
				
					<li><a href="./EventMachine/Protocols/HttpClient.html">EventMachine::Protocols::HttpClient</a></li>
				
					<li><a href="./EventMachine/Protocols/HttpClient2.html">EventMachine::Protocols::HttpClient2</a></li>
				
					<li><a href="./EventMachine/Protocols/LineAndTextProtocol.html">EventMachine::Protocols::LineAndTextProtocol</a></li>
				
					<li><a href="./EventMachine/Protocols/LineText2.html">EventMachine::Protocols::LineText2</a></li>
				
					<li><a href="./EventMachine/Protocols/Memcache.html">EventMachine::Protocols::Memcache</a></li>
				
					<li><a href="./EventMachine/Protocols/ObjectProtocol.html">EventMachine::Protocols::ObjectProtocol</a></li>
				
					<li><a href="./EventMachine/Protocols/Postgres3.html">EventMachine::Protocols::Postgres3</a></li>
				
					<li><a href="./EventMachine/Protocols/SASLauth.html">EventMachine::Protocols::SASLauth</a></li>
				
					<li><a href="./EventMachine/Protocols/SASLauthclient.html">EventMachine::Protocols::SASLauthclient</a></li>
				
					<li><a href="./EventMachine/Protocols/SmtpClient.html">EventMachine::Protocols::SmtpClient</a></li>
				
					<li><a href="./EventMachine/Protocols/SmtpServer.html">EventMachine::Protocols::SmtpServer</a></li>
				
					<li><a href="./EventMachine/Protocols/Socks4.html">EventMachine::Protocols::Socks4</a></li>
				
					<li><a href="./EventMachine/Protocols/Stomp.html">EventMachine::Protocols::Stomp</a></li>
				
					<li><a href="./EventMachine/Protocols/Stomp/Message.html">EventMachine::Protocols::Stomp::Message</a></li>
				
					<li><a href="./EventMachine/Queue.html">EventMachine::Queue</a></li>
				
					<li><a href="./EventMachine/Reactor.html">EventMachine::Reactor</a></li>
				
					<li><a href="./EventMachine/Selectable.html">EventMachine::Selectable</a></li>
				
					<li><a href="./EventMachine/SpawnedProcess.html">EventMachine::SpawnedProcess</a></li>
				
					<li><a href="./EventMachine/StreamObject.html">EventMachine::StreamObject</a></li>
				
					<li><a href="./EventMachine/Timer.html">EventMachine::Timer</a></li>
				
					<li><a href="./EventMachine/UnknownTimerFired.html">EventMachine::UnknownTimerFired</a></li>
				
					<li><a href="./EventMachine/Unsupported.html">EventMachine::Unsupported</a></li>
				
					<li><a href="./EventMachine/UuidGenerator.html">EventMachine::UuidGenerator</a></li>
				
					<li><a href="./Evma.html">Evma</a></li>
				
					<li><a href="./Evma/Container.html">Evma::Container</a></li>
				
					<li><a href="./Evma/ContainerHasObject.html">Evma::ContainerHasObject</a></li>
				
					<li><a href="./Evma/DatagramProtocol.html">Evma::DatagramProtocol</a></li>
				
					<li><a href="./Evma/Protocol.html">Evma::Protocol</a></li>
				
					<li><a href="./Evma/ProtocolFactory.html">Evma::ProtocolFactory</a></li>
				
					<li><a href="./Evma/Reactor.html">Evma::Reactor</a></li>
				
					<li><a href="./Evma/StreamProtocol.html">Evma::StreamProtocol</a></li>
				
					<li><a href="./Evma/TcpServerFactory.html">Evma::TcpServerFactory</a></li>
				
					<li><a href="./Evma/TcpSocket.html">Evma::TcpSocket</a></li>
				
					<li><a href="./Evma/UnknownTarget.html">Evma::UnknownTarget</a></li>
				
					<li><a href="./Evma/UnsupportedCallback.html">Evma::UnsupportedCallback</a></li>
				
					<li><a href="./BufferedTokenizer.html">BufferedTokenizer</a></li>
				
					<li><a href="./IO.html">IO</a></li>
				
					<li><a href="./JavaFields.html">JavaFields</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="module">EventMachine</h1>

		<div id="description">
			<pre>
 $Id$

 Author:: Francis Cianfrocca (gmail: blackhedd)
 Homepage::  http://rubyeventmachine.com
 Date:: 19 May 2006
 
 See EventMachine and EventMachine::Connection for documentation and
 usage examples.
</pre>
<hr style="height: 10px"></hr><pre>
 Copyright (C) 2006-07 by Francis Cianfrocca. All Rights Reserved.
 Gmail: blackhedd
 
 This program is free software; you can redistribute it and/or modify
 it under the terms of either: 1) the GNU General Public License
 as published by the Free Software Foundation; either version 2 of the
 License, or (at your option) any later version; or 2) Ruby's License.
 
 See the file COPYING for complete licensing information.
</pre>
<hr style="height: 10px"></hr><hr style="height: 1px"></hr><h2>Introduction</h2>
<p>
<a href="EventMachine.html">EventMachine</a> provides a fast, lightweight
framework for implementing Ruby programs that can use the network to
communicate with other processes. Using <a
href="EventMachine.html">EventMachine</a>, Ruby programmers can easily
connect to remote servers and act as servers themselves. <a
href="EventMachine.html">EventMachine</a> does not supplant the Ruby IP
libraries. It does provide an alternate technique for those applications
requiring better performance, scalability, and discipline over the behavior
of network sockets, than is easily obtainable using the built-in libraries,
especially in applications which are structurally well-suited for the
event-driven programming model.
</p>
<p>
<a href="EventMachine.html">EventMachine</a> provides a perpetual
event-loop which your programs can start and stop. Within the event loop,
TCP network connections are initiated and accepted, based on <a
href="EventMachine.html">EventMachine</a> methods called by your program.
You also define callback methods which are called by <a
href="EventMachine.html">EventMachine</a> when events of interest occur
within the event-loop.
</p>
<p>
User programs will be called back when the following events occur:
</p>
<ul>
<li><p>
When the event loop accepts network connections from remote peers
</p>
</li>
<li><p>
When data is received from network connections
</p>
</li>
<li><p>
When connections are closed, either by the local or the remote side
</p>
</li>
<li><p>
When user-defined timers expire
</p>
</li>
</ul>
<h2>Usage example</h2>
<p>
Here&#8217;s a fully-functional echo server implemented in EventMachine:
</p>
<pre>
 require 'eventmachine'

 module EchoServer
   def post_init
     puts &quot;-- someone connected to the echo server!&quot;
   end

   def receive_data data
     send_data &quot;&gt;&gt;&gt;you sent: #{data}&quot;
     close_connection if data =~ /quit/i
   end

   def unbind
     puts &quot;-- someone disconnected from the echo server!&quot;
   end
 end

 EventMachine::run {
   EventMachine::start_server &quot;127.0.0.1&quot;, 8081, EchoServer
 }
</pre>
<p>
What&#8217;s going on here? Well, we have defined the module EchoServer to
implement the semantics of the echo protocol (more about that shortly). The
last three lines invoke the event-machine itself, which runs forever unless
one of your callbacks terminates it. The block that you supply to
EventMachine::run contains code that runs immediately after the event
machine is initialized and before it starts looping. This is the place to
open up a TCP server by specifying the address and port it will listen on,
together with the module that will process the data.
</p>
<p>
Our EchoServer is extremely simple as the echo protocol doesn&#8217;t
require much work. Basically you want to send back to the remote peer
whatever data it sends you. We&#8217;ll dress it up with a little extra
text to make it interesting. Also, we&#8217;ll close the connection in case
the received data contains the word &#8220;quit.&#8220;
</p>
<p>
So what about this module EchoServer? Well, whenever a network connection
(either a client or a server) starts up, <a
href="EventMachine.html">EventMachine</a> instantiates an anonymous class,
that your module has been mixed into. Exactly one of these class instances
is created for each connection. Whenever an event occurs on a given
connection, its corresponding object automatically calls specific instance
methods which your module may redefine. The code in your module always runs
in the context of a class instance, so you can create instance variables as
you wish and they will be carried over to other callbacks made on that same
connection.
</p>
<p>
Looking back up at EchoServer, you can see that we&#8217;ve defined the
method receive_data which (big surprise) is called whenever data has been
received from the remote end of the connection. Very simple. We get the
data (a String object) and can do whatever we wish with it. In this case,
we use the method <a href="EventMachine.html#M000283">send_data</a> to
return the received data to the caller, with some extra text added in. And
if the user sends the word &#8220;quit,&#8221; we&#8217;ll close the
connection with (naturally) close_connection. (Notice that closing the
connection doesn&#8217;t terminate the processing loop, or change the fact
that your echo server is still accepting connections!) 
</p>
<h2>Questions and Futures</h2>
<p>
Would it be useful for <a href="EventMachine.html">EventMachine</a> to
incorporate the Observer pattern and make use of the corresponding Ruby
<tt>observer</tt> package? Interesting thought.
</p>
<hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr><hr style="height: 1px"></hr><hr style="height: 10px"></hr>
		</div>

		<!-- Constants -->
		
		<div id="constants-list" class="section">
			<h3 class="section-header">Constants</h3>
			<dl>
			
				<dt><a name="VERSION">VERSION</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="TimerFired">TimerFired</a></dt>
				
				<dd class="description"><p>
TODO: These event numbers are defined in way too many places. DRY them up.
</p></dd>
				
			
				<dt><a name="ConnectionData">ConnectionData</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionUnbound">ConnectionUnbound</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionAccepted">ConnectionAccepted</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionCompleted">ConnectionCompleted</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="LoopbreakSignalled">LoopbreakSignalled</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionNotifyReadable">ConnectionNotifyReadable</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionNotifyWritable">ConnectionNotifyWritable</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="SslHandshakeCompleted">SslHandshakeCompleted</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="TimerFired">TimerFired</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionData">ConnectionData</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionUnbound">ConnectionUnbound</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionAccepted">ConnectionAccepted</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="ConnectionCompleted">ConnectionCompleted</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="LoopbreakSignalled">LoopbreakSignalled</a></dt>
				
				<dd class="description"></dd>
				
			
			</dl>
		</div>
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="reactor-thread-attribute-method" class="method-detail">
				<a name="reactor_thread"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">reactor_thread</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				<p>
Exposed to allow joining on the thread, when run in a multithreaded
environment. Performing other actions on the thread has undefined
semantics.
</p>
				
				</div>
			</div>
			
			<div id="threadpool-size-attribute-method" class="method-detail">
				<a name="threadpool_size"></a>
				
				<a name="threadpool_size="></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">threadpool_size</span><span
						class="attribute-access-type">[RW]</span>
				</div>

				<div class="method-description">
				
				<p>
Size of the <a href="EventMachine.html#M000254">EventMachine.defer</a>
threadpool (defaults to 20)
</p>
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="private-class-method-details" class="method-section section">
			<h3 class="section-header">Private Class Methods</h3>

		
			<div id="klass-from-handler-method" class="method-detail ">
				<a name="M000271"></a>

				<div class="method-heading">
				
					<span class="method-name">klass_from_handler</span><span
						class="method-args">(klass = Connection, handler = nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="klass-from-handler-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1570</span>
1570:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-identifier">klass</span> = <span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span> = <span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>)
1571:     <span class="ruby-identifier">klass</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">handler</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Class</span>)
1572:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;must provide module or subclass of #{klass.name}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">klass</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">handler</span>
1573:       <span class="ruby-identifier">handler</span>
1574:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">handler</span>
1575:       <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">klass</span>){ <span class="ruby-identifier">include</span> <span class="ruby-identifier">handler</span> }
1576:     <span class="ruby-keyword kw">else</span>
1577:       <span class="ruby-identifier">klass</span>
1578:     <span class="ruby-keyword kw">end</span>
1579: 
1580:     <span class="ruby-identifier">arity</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_method</span>(<span class="ruby-value">:initialize</span>).<span class="ruby-identifier">arity</span>
1581:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">arity</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">arity</span> <span class="ruby-operator">:</span> <span class="ruby-operator">-</span>(<span class="ruby-identifier">arity</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
1582:     <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">arity</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">expected</span>) <span class="ruby-keyword kw">or</span> (<span class="ruby-identifier">arity</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">expected</span>)
1583:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;wrong number of arguments for #{klass}#initialize (#{args.size} for #{expected})&quot;</span>
1584:     <span class="ruby-keyword kw">end</span>
1585: 
1586:     <span class="ruby-identifier">klass</span>
1587:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="-allback-method" class="method-detail ">
				<a name="M000024"></a>

				<div class="method-heading">
				
					<span class="method-name">Callback</span><span
						class="method-args">(object = nil, method = nil, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Utility method for coercing arguments to an object that responds to call
Accepts an object and a method name to send to, or a block, or an object
that responds to call.
</p>
<pre>
 cb = EM.Callback{ |msg| puts(msg) }
 cb.call('hello world')

 cb = EM.Callback(Object, :puts)
 cb.call('hello world')

 cb = EM.Callback(proc{ |msg| puts(msg) })
 cb.call('hello world')</pre>
					

					
					<div class="method-source-code"
						id="-allback-source">
<pre>
    <span class="ruby-comment cmt"># File lib/em/callback.rb, line 15</span>
15:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-constant">Callback</span>(<span class="ruby-identifier">object</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">method</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">blk</span>)
16:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">method</span>
17:       <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span> }
18:     <span class="ruby-keyword kw">else</span>
19:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:call</span>
20:         <span class="ruby-identifier">object</span>
21:       <span class="ruby-keyword kw">else</span> 
22:         <span class="ruby-identifier">blk</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>)
23:       <span class="ruby-keyword kw">end</span>
24:     <span class="ruby-keyword kw">end</span>
25:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="add-oneshot-timer-method" class="method-detail ">
				<a name="M000317"></a>

				<div class="method-heading">
				
					<span class="method-name">add_oneshot_timer</span><span
						class="method-args">(interval)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000277">add_oneshot_timer</a>
</p>
					

					
					<div class="method-source-code"
						id="add-oneshot-timer-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 58</span>
58:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_oneshot_timer</span> <span class="ruby-identifier">interval</span>
59:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">install_oneshot_timer</span>(<span class="ruby-identifier">interval</span> <span class="ruby-operator">/</span> <span class="ruby-value">1000</span>)
60:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="add-oneshot-timer-method" class="method-detail ">
				<a name="M000277"></a>

				<div class="method-heading">
				
					<span class="method-name">add_oneshot_timer</span><span
						class="method-args">(interval)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="add-oneshot-timer-source">
<pre>
    <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 97</span>
97:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_oneshot_timer</span> <span class="ruby-identifier">interval</span>
98:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">installOneshotTimer</span> <span class="ruby-identifier">interval</span>
99:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="add-periodic-timer-method" class="method-detail ">
				<a name="M000235"></a>

				<div class="method-heading">
				
					<span class="method-name">add_periodic_timer</span><span
						class="method-args">(*args, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000235">EventMachine#add_periodic_timer</a>
adds a periodic timer to the event loop. It takes the same parameters as
the one-shot timer method, <a
href="EventMachine.html#M000234">EventMachine#add_timer</a>. This method
schedules execution of the given block repeatedly, at intervals of time
<em>at least</em> as great as the number of seconds given in the first
parameter to the call.
</p>
<h3>Usage example</h3>
<p>
The following sample program will write a dollar-sign to stderr every five
seconds. (Of course if the program defined network clients and/or servers,
they would be doing their work while the periodic timer is counting off.)
</p>
<pre>
 EventMachine::run {
   EventMachine::add_periodic_timer( 5 ) { $stderr.write &quot;$&quot; }
 }
</pre>
<p>
Also see <a
href="EventMachine/PeriodicTimer.html">EventMachine::PeriodicTimer</a>
</p>
					

					
					<div class="method-source-code"
						id="add-periodic-timer-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 400</span>
400:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_periodic_timer</span> *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>
401:     <span class="ruby-identifier">interval</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
402:     <span class="ruby-identifier">code</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
403: 
404:     <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-constant">PeriodicTimer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">interval</span>, <span class="ruby-identifier">code</span>)
405:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="add-timer-method" class="method-detail ">
				<a name="M000234"></a>

				<div class="method-heading">
				
					<span class="method-name">add_timer</span><span
						class="method-args">(*args, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000234">EventMachine#add_timer</a> adds a
one-shot timer to the event loop. Call it with one or two parameters. The
first parameters is a delay-time expressed in <em>seconds</em> (not
milliseconds). The second parameter, if present, must be a proc object. If
a proc object is not given, then you can also simply pass a block to the
method call.
</p>
<p>
<a href="EventMachine.html#M000234">EventMachine#add_timer</a> may be
called from the block passed to <a
href="EventMachine.html#M000229">EventMachine#run</a> or from any callback
method. It schedules execution of the proc or block passed to <a
href="EventMachine.html#M000234">add_timer</a>, after the passage of an
interval of time equal to <em>at least</em> the number of seconds specified
in the first parameter to the call.
</p>
<p>
<a href="EventMachine.html#M000234">EventMachine#add_timer</a> is a
<em>non-blocking</em> call. Callbacks can and will be called during the
interval of time that the timer is in effect. There is no built-in limit to
the number of timers that can be outstanding at any given time.
</p>
<h3>Usage example</h3>
<p>
This example shows how easy timers are to use. Observe that two timers are
initiated simultaneously. Also, notice that the event loop will continue to
run even after the second timer event is processed, since there was no call
to <a href="EventMachine.html#M000237">EventMachine#stop_event_loop</a>.
There will be no activity, of course, since no network clients or servers
are defined. Stop the program with Ctrl-C.
</p>
<pre>
 EventMachine::run {
   puts &quot;Starting the run now: #{Time.now}&quot;
   EventMachine::add_timer 5, proc { puts &quot;Executing timer event: #{Time.now}&quot; }
   EventMachine::add_timer( 10 ) { puts &quot;Executing timer event: #{Time.now}&quot; }
 }
</pre>
<p>
Also see <a href="EventMachine/Timer.html">EventMachine::Timer</a>
</p>
					

					
					<div class="method-source-code"
						id="add-timer-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 370</span>
370:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_timer</span> *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>
371:     <span class="ruby-identifier">interval</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
372:     <span class="ruby-identifier">code</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
373:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">code</span>
374:       <span class="ruby-comment cmt"># check too many timers!</span>
375:       <span class="ruby-identifier">s</span> = <span class="ruby-identifier">add_oneshot_timer</span>((<span class="ruby-identifier">interval</span>.<span class="ruby-identifier">to_f</span> * <span class="ruby-value">1000</span>).<span class="ruby-identifier">to_i</span>)
376:       <span class="ruby-ivar">@timers</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">code</span>
377:       <span class="ruby-identifier">s</span>
378:     <span class="ruby-keyword kw">end</span>
379:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="attach-method" class="method-detail ">
				<a name="M000244"></a>

				<div class="method-heading">
				
					<span class="method-name">attach</span><span
						class="method-args">(io, handler=nil, *args, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Attaches an <a href="IO.html">IO</a> object or file descriptor to the
eventloop as a regular connection. The file descriptor will be set as
non-blocking, and <a href="EventMachine.html">EventMachine</a> will process
receive_data and <a href="EventMachine.html#M000283">send_data</a> events
on it as it would for any other connection.
</p>
<p>
To watch a fd instead, use EventMachine::watch, which will not alter the
state of the socket and fire notify_readable and notify_writable events
instead.
</p>
					

					
					<div class="method-source-code"
						id="attach-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 778</span>
778:   <span class="ruby-keyword kw">def</span> <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">attach</span> <span class="ruby-identifier">io</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
779:     <span class="ruby-identifier">attach_io</span> <span class="ruby-identifier">io</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
780:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="attach-fd-method" class="method-detail ">
				<a name="M000307"></a>

				<div class="method-heading">
				
					<span class="method-name">attach_fd</span><span
						class="method-args">(fileno, watch_mode)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="attach-fd-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">attach_fd</span> <span class="ruby-identifier">fileno</span>, <span class="ruby-identifier">watch_mode</span>
193:     <span class="ruby-comment cmt"># 3Aug09: We could pass in the actual SocketChannel, but then it would be modified (set as non-blocking), and</span>
194:     <span class="ruby-comment cmt"># we would need some logic to make sure detach_fd below didn't clobber it. For now, we just always make a new</span>
195:     <span class="ruby-comment cmt"># SocketChannel for the underlying file descriptor</span>
196:     <span class="ruby-comment cmt"># if fileno.java_kind_of? SocketChannel</span>
197:     <span class="ruby-comment cmt">#   ch = fileno</span>
198:     <span class="ruby-comment cmt">#   ch.configureBlocking(false)</span>
199:     <span class="ruby-comment cmt">#   fileno = nil</span>
200:     <span class="ruby-comment cmt"># elsif fileno.java_kind_of? java.nio.channels.Channel</span>
201: 
202:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fileno</span>.<span class="ruby-identifier">java_kind_of?</span> <span class="ruby-identifier">java</span>.<span class="ruby-identifier">nio</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-constant">Channel</span>
203:       <span class="ruby-identifier">field</span> = <span class="ruby-identifier">fileno</span>.<span class="ruby-identifier">getClass</span>.<span class="ruby-identifier">getDeclaredField</span>(<span class="ruby-value str">'fdVal'</span>)
204:       <span class="ruby-identifier">field</span>.<span class="ruby-identifier">setAccessible</span>(<span class="ruby-keyword kw">true</span>)
205:       <span class="ruby-identifier">fileno</span> = <span class="ruby-identifier">field</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">fileno</span>)
206:     <span class="ruby-keyword kw">else</span>
207:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">'attach_fd requires Java Channel or POSIX fileno'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">fileno</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Fixnum</span>
208:     <span class="ruby-keyword kw">end</span>
209: 
210:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fileno</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
211:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;can't open STDIN as selectable in Java =(&quot;</span>
212:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">fileno</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Fixnum</span>
213:       <span class="ruby-comment cmt"># 8Aug09: The following code is specific to the sun jvm's SocketChannelImpl. Is there a cross-platform</span>
214:       <span class="ruby-comment cmt"># way of implementing this? If so, also remember to update EventableSocketChannel#close and #cleanup</span>
215:       <span class="ruby-identifier">fd</span> = <span class="ruby-constant">FileDescriptor</span>.<span class="ruby-identifier">new</span>
216:       <span class="ruby-identifier">fd</span>.<span class="ruby-identifier">set_field</span> <span class="ruby-value str">'fd'</span>, <span class="ruby-identifier">fileno</span>
217: 
218:       <span class="ruby-identifier">ch</span> = <span class="ruby-constant">SocketChannel</span>.<span class="ruby-identifier">open</span>
219:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">configureBlocking</span>(<span class="ruby-keyword kw">false</span>)
220:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">kill</span>
221:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">set_field</span> <span class="ruby-value str">'fd'</span>, <span class="ruby-identifier">fd</span>
222:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">set_field</span> <span class="ruby-value str">'fdVal'</span>, <span class="ruby-identifier">fileno</span>
223:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">set_field</span> <span class="ruby-value str">'state'</span>, <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-value str">'ST_CONNECTED'</span>)
224:     <span class="ruby-keyword kw">end</span>
225: 
226:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">attachChannel</span>(<span class="ruby-identifier">ch</span>,<span class="ruby-identifier">watch_mode</span>)
227:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="bind-connect-method" class="method-detail ">
				<a name="M000242"></a>

				<div class="method-heading">
				
					<span class="method-name">bind_connect</span><span
						class="method-args">(bind_addr, bind_port, server, port=nil, handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine::bind_connect is like EventMachine::connect, but allows for a
local address/port to bind the connection to.
</p>
					

					
					<div class="method-source-code"
						id="bind-connect-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 697</span>
697:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">bind_connect</span> <span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>
698:     <span class="ruby-keyword kw">begin</span>
699:       <span class="ruby-identifier">port</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">port</span>)
700:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-constant">TypeError</span>
701:       <span class="ruby-comment cmt"># there was no port, so server must be a unix domain socket</span>
702:       <span class="ruby-comment cmt"># the port argument is actually the handler, and the handler is one of the args</span>
703:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">handler</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">handler</span>
704:       <span class="ruby-identifier">handler</span> = <span class="ruby-identifier">port</span>
705:       <span class="ruby-identifier">port</span> = <span class="ruby-keyword kw">nil</span>
706:     <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">port</span>
707: 
708:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
709: 
710:     <span class="ruby-identifier">s</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">port</span>
711:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bind_addr</span>
712:             <span class="ruby-identifier">bind_connect_server</span> <span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
713:           <span class="ruby-keyword kw">else</span>
714:             <span class="ruby-identifier">connect_server</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
715:           <span class="ruby-keyword kw">end</span>
716:         <span class="ruby-keyword kw">else</span>
717:           <span class="ruby-identifier">connect_unix_server</span> <span class="ruby-identifier">server</span>
718:         <span class="ruby-keyword kw">end</span>
719: 
720:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
721:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
722:     <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span>
723:     <span class="ruby-identifier">c</span>
724:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="bind-connect-server-method" class="method-detail ">
				<a name="M000322"></a>

				<div class="method-heading">
				
					<span class="method-name">bind_connect_server</span><span
						class="method-args">(bind_addr, bind_port, host, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="bind-connect-server-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 82</span>
82:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">bind_connect_server</span> <span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
83:       <span class="ruby-constant">EvmaTCPClient</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>).<span class="ruby-identifier">uuid</span>
84:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="bind-connect-server-method" class="method-detail ">
				<a name="M000286"></a>

				<div class="method-heading">
				
					<span class="method-name">bind_connect_server</span><span
						class="method-args">(bind_addr, bind_port, server, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="bind-connect-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 125</span>
125:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">bind_connect_server</span> <span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
126:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">connectTcpServer</span> <span class="ruby-identifier">bind_addr</span>, <span class="ruby-identifier">bind_port</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
127:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="cancel-timer-method" class="method-detail ">
				<a name="M000236"></a>

				<div class="method-heading">
				
					<span class="method-name">cancel_timer</span><span
						class="method-args">(timer_or_sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Cancel a timer using its signature. You can also use <a
href="EventMachine/Timer.html#M000224">EventMachine::Timer#cancel</a>
</p>
					

					
					<div class="method-source-code"
						id="cancel-timer-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 409</span>
409:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cancel_timer</span> <span class="ruby-identifier">timer_or_sig</span>
410:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">timer_or_sig</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:cancel</span>
411:       <span class="ruby-identifier">timer_or_sig</span>.<span class="ruby-identifier">cancel</span>
412:     <span class="ruby-keyword kw">else</span>
413:       <span class="ruby-ivar">@timers</span>[<span class="ruby-identifier">timer_or_sig</span>] = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@timers</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">timer_or_sig</span>)
414:     <span class="ruby-keyword kw">end</span>
415:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="close-connection-method" class="method-detail ">
				<a name="M000287"></a>

				<div class="method-heading">
				
					<span class="method-name">close_connection</span><span
						class="method-args">(sig, after_writing)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="close-connection-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">close_connection</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">after_writing</span>
129:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">closeConnection</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">after_writing</span>
130:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="close-connection-method" class="method-detail ">
				<a name="M000324"></a>

				<div class="method-heading">
				
					<span class="method-name">close_connection</span><span
						class="method-args">(target, after_writing)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000287">close_connection</a> The extension
version does NOT raise any kind of an error if an attempt is made to close
a non-existent connection. Not sure whether we should. For now, we&#8217;ll
raise an error here in that case.
</p>
					

					
					<div class="method-source-code"
						id="close-connection-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 96</span>
96:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close_connection</span> <span class="ruby-identifier">target</span>, <span class="ruby-identifier">after_writing</span>
97:       <span class="ruby-identifier">selectable</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">target</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown close_connection target&quot;</span>
98:       <span class="ruby-identifier">selectable</span>.<span class="ruby-identifier">schedule_close</span> <span class="ruby-identifier">after_writing</span>
99:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connect-method" class="method-detail ">
				<a name="M000241"></a>

				<div class="method-heading">
				
					<span class="method-name">connect</span><span
						class="method-args">(server, port=nil, handler=nil, *args, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000241">EventMachine#connect</a> initiates a
TCP connection to a remote server and sets up event-handling for the
connection. You can call <a
href="EventMachine.html#M000241">EventMachine#connect</a> in the block
supplied to <a href="EventMachine.html#M000229">EventMachine#run</a> or in
any callback method.
</p>
<p>
<a href="EventMachine.html#M000241">EventMachine#connect</a> takes the IP
address (or hostname) and port of the remote server you want to connect to.
It also takes an optional handler Module which you must define, that
contains the callbacks that will be invoked by the event loop on behalf of
the connection.
</p>
<p>
See the description of <a
href="EventMachine.html#M000238">EventMachine#start_server</a> for a
discussion of the handler Module. All of the details given in that
description apply for connections created with <a
href="EventMachine.html#M000241">EventMachine#connect</a>.
</p>
<h3>Usage Example</h3>
<p>
Here&#8217;s a program which connects to a web server, sends a naive
request, parses the HTTP header of the response, and then (antisocially)
ends the event loop, which automatically drops the connection (and
incidentally calls the connection&#8217;s unbind method).
</p>
<pre>
 module DumbHttpClient
   def post_init
     send_data &quot;GET / HTTP/1.1\r\nHost: _\r\n\r\n&quot;
     @data = &quot;&quot;
     @parsed = false
   end
 
   def receive_data data
     @data &lt;&lt; data
     if !@parsed and @data =~ /[\n][\r]*[\n]/m
       @parsed = true
       puts &quot;RECEIVED HTTP HEADER:&quot;
       $`.each {|line| puts &quot;&gt;&gt;&gt; #{line}&quot; }
 
       puts &quot;Now we'll terminate the loop, which will also close the connection&quot;
       EventMachine::stop_event_loop
     end
   end
 
   def unbind
     puts &quot;A connection has terminated&quot;
   end
 end
 
 EventMachine::run {
   EventMachine::connect &quot;www.bayshorenetworks.com&quot;, 80, DumbHttpClient
 }
 puts &quot;The event loop has ended&quot;
 
</pre>
<p>
There are times when it&#8217;s more convenient to define a protocol
handler as a Class rather than a Module. Here&#8217;s how to do this:
</p>
<pre>
 class MyProtocolHandler &lt; EventMachine::Connection
   def initialize *args
     super
     # whatever else you want to do here
   end
   
   #.......your other class code
 end
</pre>
<p>
If you do this, then an instance of your class will be instantiated to
handle every network connection created by your code or accepted by servers
that you create. If you redefine post_init in your protocol-handler class,
your post_init method will be called <em>inside</em> the call to super that
you will make in your initialize method (if you provide one).
</p>
					

					
					<div class="method-source-code"
						id="connect-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 691</span>
691:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">connect</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
692:     <span class="ruby-identifier">bind_connect</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
693:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connect-server-method" class="method-detail ">
				<a name="M000321"></a>

				<div class="method-heading">
				
					<span class="method-name">connect_server</span><span
						class="method-args">(host, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000285">connect_server</a>. Return a connection
descriptor to the caller. TODO, what do we return here if we can&#8217;t
connect?
</p>
					

					
					<div class="method-source-code"
						id="connect-server-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 78</span>
78:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connect_server</span> <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
79:       <span class="ruby-identifier">bind_connect_server</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
80:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connect-server-method" class="method-detail ">
				<a name="M000285"></a>

				<div class="method-heading">
				
					<span class="method-name">connect_server</span><span
						class="method-args">(server, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="connect-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">connect_server</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
123:     <span class="ruby-identifier">bind_connect_server</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
124:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connect-unix-domain-method" class="method-detail ">
				<a name="M000247"></a>

				<div class="method-heading">
				
					<span class="method-name">connect_unix_domain</span><span
						class="method-args">(socketname, *args, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Make a connection to a Unix-domain socket. This is not implemented on
Windows platforms. The parameter socketname is a String which identifies
the Unix-domain socket you want to connect to. socketname is the name of a
file on your local system, and in most cases is a fully-qualified path
name. Make sure that your process has enough local permissions to open the
Unix-domain socket. See also the documentation for <a
href="EventMachine.html#M000241">connect</a>. This method behaves like <a
href="EventMachine.html#M000241">connect</a> in all respects except for the
fact that it connects to a local Unix-domain socket rather than a TCP
socket.
</p>
<p>
Note that this method is simply an alias for <a
href="EventMachine.html#M000241">connect</a>, which can connect to both TCP
and Unix-domain sockets
</p>
					

					
					<div class="method-source-code"
						id="connect-unix-domain-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 845</span>
845:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">connect_unix_domain</span> <span class="ruby-identifier">socketname</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
846:     <span class="ruby-identifier">connect</span> <span class="ruby-identifier">socketname</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
847:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connect-unix-server-method" class="method-detail ">
				<a name="M000328"></a>

				<div class="method-heading">
				
					<span class="method-name">connect_unix_server</span><span
						class="method-args">(chain)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000328">connect_unix_server</a>
</p>
					

					
					<div class="method-source-code"
						id="connect-unix-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connect_unix_server</span> <span class="ruby-identifier">chain</span>
121:       <span class="ruby-constant">EvmaUNIXClient</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">chain</span>).<span class="ruby-identifier">uuid</span>
122:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="connection-count-method" class="method-detail ">
				<a name="M000252"></a>

				<div class="method-heading">
				
					<span class="method-name">connection_count</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the total number of connections (file descriptors) currently held
by the reactor. Note that a tick must pass after the
&#8216;initiation&#8217; of a connection for this number to increment.
It&#8217;s usually accurate, but don&#8217;t rely on the exact precision of
this number unless you really know <a href="EventMachine.html">EM</a>
internals.
</p>
<p>
For example, $count will be 0 in this case:
</p>
<pre>
 EM.run {
   EM.connect(&quot;rubyeventmachine.com&quot;, 80)
   $count = EM.connection_count
 }
</pre>
<p>
In this example, $count will be 1 since the connection has been established
in the next loop of the reactor.
</p>
<pre>
 EM.run {
   EM.connect(&quot;rubyeventmachine.com&quot;, 80)
   EM.next_tick {
     $count = EM.connection_count
   }
 }</pre>
					

					
					<div class="method-source-code"
						id="connection-count-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 974</span>
974:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">connection_count</span>
975:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_connection_count</span>
976:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="defer-method" class="method-detail ">
				<a name="M000254"></a>

				<div class="method-heading">
				
					<span class="method-name">defer</span><span
						class="method-args">(op = nil, callback = nil, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000254">defer</a> is for integrating blocking
operations into EventMachine&#8217;s control flow. Call <a
href="EventMachine.html#M000254">defer</a> with one or two blocks, as shown
below (the second block is <em>optional</em>):
</p>
<pre>
 operation = proc {
   # perform a long-running operation here, such as a database query.
   &quot;result&quot; # as usual, the last expression evaluated in the block will be the return value.
 }
 callback = proc {|result|
   # do something with result here, such as send it back to a network client.
 }

 EventMachine.defer( operation, callback )
</pre>
<p>
The action of <a href="EventMachine.html#M000254">defer</a> is to take the
block specified in the first parameter (the &#8220;operation&#8221;) and
schedule it for asynchronous execution on an internal thread pool
maintained by <a href="EventMachine.html">EventMachine</a>. When the
operation completes, it will pass the result computed by the block (if any)
back to the <a href="EventMachine.html">EventMachine</a> reactor. Then, <a
href="EventMachine.html">EventMachine</a> calls the block specified in the
second parameter to <a href="EventMachine.html#M000254">defer</a> (the
&#8220;callback&#8221;), as part of its normal, synchronous event handling
loop. The result computed by the operation block is passed as a parameter
to the callback. You may omit the callback parameter if you don&#8217;t
need to execute any code after the operation completes.
</p>
<h2>Caveats</h2>
<p>
Note carefully that the code in your deferred operation will be executed on
a separate thread from the main <a
href="EventMachine.html">EventMachine</a> processing and all other Ruby
threads that may exist in your program. Also, multiple deferred operations
may be running at once! Therefore, you are responsible for ensuring that
your operation code is threadsafe. [Need more explanation and examples.]
Don&#8217;t write a deferred operation that will block forever. If so, the
current implementation will not detect the problem, and the thread will
never be returned to the pool. <a href="EventMachine.html">EventMachine</a>
limits the number of threads in its pool, so if you do this enough times,
your subsequent deferred operations won&#8217;t get a chance to run. [We
might put in a timer to detect this problem.]
</p>
					

					
					<div class="method-source-code"
						id="defer-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1043</span>
1043:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">defer</span> <span class="ruby-identifier">op</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">callback</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">blk</span>
1044:     <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@threadpool</span>
1045:       <span class="ruby-identifier">require</span> <span class="ruby-value str">'thread'</span>
1046:       <span class="ruby-ivar">@threadpool</span> = []
1047:       <span class="ruby-ivar">@threadqueue</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Queue</span>.<span class="ruby-identifier">new</span>
1048:       <span class="ruby-ivar">@resultqueue</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Queue</span>.<span class="ruby-identifier">new</span>
1049:       <span class="ruby-identifier">spawn_threadpool</span>
1050:     <span class="ruby-keyword kw">end</span>
1051: 
1052:     <span class="ruby-ivar">@threadqueue</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">op</span><span class="ruby-operator">||</span><span class="ruby-identifier">blk</span>,<span class="ruby-identifier">callback</span>]
1053:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="detach-fd-method" class="method-detail ">
				<a name="M000308"></a>

				<div class="method-heading">
				
					<span class="method-name">detach_fd</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="detach-fd-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 228</span>
228:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">detach_fd</span> <span class="ruby-identifier">sig</span>
229:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span> = <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">detachChannel</span>(<span class="ruby-identifier">sig</span>)
230:       <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">get_field</span> <span class="ruby-value str">'fdVal'</span>
231:     <span class="ruby-keyword kw">end</span>
232:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="disable-proxy-method" class="method-detail ">
				<a name="M000266"></a>

				<div class="method-heading">
				
					<span class="method-name">disable_proxy</span><span
						class="method-args">(from)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000266">disable_proxy</a> takes just one
argument, a <a href="EventMachine/Connection.html">Connection</a> that has
proxying enabled via enable_proxy. Calling this method will remove that
functionality and your connection will begin receiving data via
receive_data again.
</p>
					

					
					<div class="method-source-code"
						id="disable-proxy-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1379</span>
1379:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">disable_proxy</span>(<span class="ruby-identifier">from</span>)
1380:     <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">stop_proxy</span>(<span class="ruby-identifier">from</span>.<span class="ruby-identifier">signature</span>)
1381:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="enable-proxy-method" class="method-detail ">
				<a name="M000265"></a>

				<div class="method-heading">
				
					<span class="method-name">enable_proxy</span><span
						class="method-args">(from, to, bufsize=0)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000265">enable_proxy</a> allows for direct
writing of incoming data back out to another descriptor, at the C++ level
in the reactor. This is especially useful for proxies where high
performance is required. Propogating data from a server response all the
way up to Ruby, and then back down to the reactor to be sent back to the
client, is often unnecessary and incurs a significant performance decrease.
</p>
<p>
The two arguments are Connections, &#8216;from&#8217; and &#8216;to&#8217;.
&#8216;from&#8217; is the connection whose inbound data you want relayed
back out. &#8216;to&#8217; is the connection to write it to.
</p>
<p>
Once you call this method, the &#8216;from&#8217; connection will no longer
get receive_data callbacks from the reactor, except in the case that
&#8216;to&#8217; connection has already closed when attempting to write to
it. You can see in the example, that proxy_target_unbound will be called
when this occurs. After that, further incoming data will be passed into
receive_data as normal.
</p>
<p>
Note also that this feature supports different types of descriptors - TCP,
UDP, and pipes. You can relay data from one kind to another.
</p>
<p>
Example:
</p>
<pre>
 module ProxyConnection
   def initialize(client, request)
     @client, @request = client, request
   end

   def post_init
     EM::enable_proxy(self, @client)
   end

   def connection_completed
     send_data @request
   end

   def proxy_target_unbound
     close_connection
   end

   def unbind
     @client.close_connection_after_writing
   end
 end

 module ProxyServer
   def receive_data(data)
     (@buf ||= &quot;&quot;) &lt;&lt; data
     if @buf =~ /\r\n\r\n/ # all http headers received
       EM.connect(&quot;10.0.0.15&quot;, 80, ProxyConnection, self, data)
     end
   end
 end

 EM.run {
   EM.start_server(&quot;127.0.0.1&quot;, 8080, ProxyServer)
 }</pre>
					

					
					<div class="method-source-code"
						id="enable-proxy-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1372</span>
1372:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">enable_proxy</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>, <span class="ruby-identifier">bufsize</span>=<span class="ruby-value">0</span>)
1373:     <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">start_proxy</span>(<span class="ruby-identifier">from</span>.<span class="ruby-identifier">signature</span>, <span class="ruby-identifier">to</span>.<span class="ruby-identifier">signature</span>, <span class="ruby-identifier">bufsize</span>)
1374:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="epoll-method" class="method-detail ">
				<a name="M000293"></a>

				<div class="method-heading">
				
					<span class="method-name">epoll</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="epoll-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 146</span>
146:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">epoll</span>
147:     <span class="ruby-comment cmt"># Epoll is a no-op for Java.</span>
148:     <span class="ruby-comment cmt"># The latest Java versions run epoll when possible in NIO.</span>
149:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="epoll-method" class="method-detail ">
				<a name="M000334"></a>

				<div class="method-heading">
				
					<span class="method-name">epoll</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000293">epoll</a> is a harmless no-op in the
pure-Ruby implementation. This is intended to ensure that user code behaves
properly across different <a href="EventMachine.html">EM</a>
implementations.
</p>
					

					
					<div class="method-source-code"
						id="epoll-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 156</span>
156:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">epoll</span>
157:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="epoll--method" class="method-detail ">
				<a name="M000294"></a>

				<div class="method-heading">
				
					<span class="method-name">epoll=</span><span
						class="method-args">(val)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="epoll--source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">epoll=</span> <span class="ruby-identifier">val</span>
151:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="epoll--method" class="method-detail ">
				<a name="M000297"></a>

				<div class="method-heading">
				
					<span class="method-name">epoll?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="epoll--source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 156</span>
156:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">epoll?</span>
157:     <span class="ruby-keyword kw">false</span>
158:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="error-handler-method" class="method-detail ">
				<a name="M000264"></a>

				<div class="method-heading">
				
					<span class="method-name">error_handler</span><span
						class="method-args">(cb = nil, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Catch-all for errors raised during event loop callbacks.
</p>
<pre>
 EM.error_handler{ |e|
   puts &quot;Error raised during event loop: #{e.message}&quot;
 }</pre>
					

					
					<div class="method-source-code"
						id="error-handler-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1312</span>
1312:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">error_handler</span> <span class="ruby-identifier">cb</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">blk</span>
1313:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cb</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">blk</span>
1314:       <span class="ruby-ivar">@error_handler</span> = <span class="ruby-identifier">cb</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">blk</span>
1315:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">instance_variable_defined?</span> <span class="ruby-value">:@error_handler</span>
1316:       <span class="ruby-identifier">remove_instance_variable</span> <span class="ruby-value">:@error_handler</span>
1317:     <span class="ruby-keyword kw">end</span>
1318:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="event-callback-method" class="method-detail ">
				<a name="M000000"></a>

				<div class="method-heading">
				
					<span class="method-name">event_callback</span><span
						class="method-args">(target, opcode, data)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="event-callback-source">
<pre>
    <span class="ruby-comment cmt"># File lib/evma/callback.rb, line 28</span>
28: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">event_callback</span> <span class="ruby-identifier">target</span>, <span class="ruby-identifier">opcode</span>, <span class="ruby-identifier">data</span>
29:   <span class="ruby-constant">Evma</span><span class="ruby-operator">::</span><span class="ruby-constant">Container</span>.<span class="ruby-identifier">callback</span> <span class="ruby-identifier">target</span>, <span class="ruby-identifier">opcode</span>, <span class="ruby-identifier">data</span>
30: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="fork-reactor-method" class="method-detail ">
				<a name="M000233"></a>

				<div class="method-heading">
				
					<span class="method-name">fork_reactor</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000233">fork_reactor</a> forks a new process
and calls <a href="EventMachine.html#M000229">EM#run</a> inside of it,
passing your block.
</p>
					

					
					<div class="method-source-code"
						id="fork-reactor-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 322</span>
322:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fork_reactor</span> &amp;<span class="ruby-identifier">block</span>
323:     <span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">fork</span> <span class="ruby-keyword kw">do</span>
324:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reactor_running?</span>
325:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stop_event_loop</span>
326:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">release_machine</span>
327:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_variable_set</span>( <span class="ruby-value str">'@reactor_running'</span>, <span class="ruby-keyword kw">false</span> )
328:       <span class="ruby-keyword kw">end</span>
329:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">block</span>
330:     <span class="ruby-keyword kw">end</span>
331:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-connection-count-method" class="method-detail ">
				<a name="M000313"></a>

				<div class="method-heading">
				
					<span class="method-name">get_connection_count</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-connection-count-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_connection_count</span>
248:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">getConnectionCount</span>
249:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-max-timer-count-method" class="method-detail ">
				<a name="M000304"></a>

				<div class="method-heading">
				
					<span class="method-name">get_max_timer_count</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-max-timer-count-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 180</span>
180:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_max_timer_count</span>
181:     <span class="ruby-comment cmt"># harmless no-op in Java. There's no built-in timer limit.</span>
182:     <span class="ruby-ivar">@max_timer_count</span> <span class="ruby-operator">||</span> <span class="ruby-value">100_000</span>
183:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-max-timers-method" class="method-detail ">
				<a name="M000251"></a>

				<div class="method-heading">
				
					<span class="method-name">get_max_timers</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Gets the current maximum number of allowed timers
</p>
					

					
					<div class="method-source-code"
						id="get-max-timers-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 950</span>
950:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_max_timers</span>
951:     <span class="ruby-identifier">get_max_timer_count</span>
952:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-outbound-data-size-method" class="method-detail ">
				<a name="M000339"></a>

				<div class="method-heading">
				
					<span class="method-name">get_outbound_data_size</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000339">get_outbound_data_size</a>
</p>
					

					
					<div class="method-source-code"
						id="get-outbound-data-size-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 190</span>
190:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_outbound_data_size</span> <span class="ruby-identifier">sig</span>
191:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">sig</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown get_outbound_data_size target&quot;</span>
192:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">get_outbound_data_size</span>
193:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-peername-method" class="method-detail ">
				<a name="M000306"></a>

				<div class="method-heading">
				
					<span class="method-name">get_peername</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-peername-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_peername</span> <span class="ruby-identifier">sig</span>
188:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peer</span> = <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">getPeerName</span>(<span class="ruby-identifier">sig</span>)
189:       <span class="ruby-constant">Socket</span>.<span class="ruby-identifier">pack_sockaddr_in</span> *<span class="ruby-identifier">peer</span>
190:     <span class="ruby-keyword kw">end</span>
191:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-peername-method" class="method-detail ">
				<a name="M000330"></a>

				<div class="method-heading">
				
					<span class="method-name">get_peername</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000306">get_peername</a>
</p>
					

					
					<div class="method-source-code"
						id="get-peername-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 130</span>
130:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_peername</span> <span class="ruby-identifier">sig</span>
131:       <span class="ruby-identifier">selectable</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">sig</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown get_peername target&quot;</span>
132:       <span class="ruby-identifier">selectable</span>.<span class="ruby-identifier">get_peername</span>
133:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="heartbeat-interval-method" class="method-detail ">
				<a name="M000267"></a>

				<div class="method-heading">
				
					<span class="method-name">heartbeat_interval</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Retrieve the heartbeat interval. This is how often <a
href="EventMachine.html">EventMachine</a> will check for dead connections
that have had an InactivityTimeout set via <a
href="EventMachine/Connection.html#M000058">Connection#set_comm_inactivity_timeout</a>.
Default is 2 seconds.
</p>
					

					
					<div class="method-source-code"
						id="heartbeat-interval-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1386</span>
1386:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">heartbeat_interval</span>
1387:     <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">get_heartbeat_interval</span>
1388:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="heartbeat-interval--method" class="method-detail ">
				<a name="M000268"></a>

				<div class="method-heading">
				
					<span class="method-name">heartbeat_interval=</span><span
						class="method-args">(time)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Set the heartbeat interval. This is how often <a
href="EventMachine.html">EventMachine</a> will check for dead connections
that have had an InactivityTimeout set via <a
href="EventMachine/Connection.html#M000058">Connection#set_comm_inactivity_timeout</a>.
Takes a Numeric number of seconds. Default is 2.
</p>
					

					
					<div class="method-source-code"
						id="heartbeat-interval--source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1393</span>
1393:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">heartbeat_interval=</span> (<span class="ruby-identifier">time</span>)
1394:     <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_heartbeat_interval</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_f</span>
1395:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="initialize-event-machine-method" class="method-detail ">
				<a name="M000316"></a>

				<div class="method-heading">
				
					<span class="method-name">initialize_event_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000275">initialize_event_machine</a>
</p>
					

					
					<div class="method-source-code"
						id="initialize-event-machine-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 50</span>
50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_event_machine</span>
51:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">initialize_for_run</span>
52:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="initialize-event-machine-method" class="method-detail ">
				<a name="M000275"></a>

				<div class="method-heading">
				
					<span class="method-name">initialize_event_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
class <a href="EventMachine/Connection.html">Connection</a> <
com.rubyeventmachine.Connection
</p>
<pre>
  def associate_callback_target sig
    # No-op for the time being.
  end
</pre>
<p>
end
</p>
					

					
					<div class="method-source-code"
						id="initialize-event-machine-source">
<pre>
    <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 91</span>
91:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">initialize_event_machine</span>
92:     <span class="ruby-ivar">@em</span> = <span class="ruby-constant">JEM</span>.<span class="ruby-identifier">new</span>
93:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="invoke-popen-method" class="method-detail ">
				<a name="M000301"></a>

				<div class="method-heading">
				
					<span class="method-name">invoke_popen</span><span
						class="method-args">(cmd)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="invoke-popen-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 168</span>
168:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">invoke_popen</span> <span class="ruby-identifier">cmd</span>
169:     <span class="ruby-comment cmt"># TEMPORARILY unsupported until someone figures out how to do it.</span>
170:     <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unsupported on this platform&quot;</span>
171:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="is-notify-readable-method" class="method-detail ">
				<a name="M000311"></a>

				<div class="method-heading">
				
					<span class="method-name">is_notify_readable</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="is-notify-readable-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 241</span>
241:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">is_notify_readable</span> <span class="ruby-identifier">sig</span>
242:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">isNotifyReadable</span>(<span class="ruby-identifier">sig</span>)
243:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="is-notify-writable-method" class="method-detail ">
				<a name="M000312"></a>

				<div class="method-heading">
				
					<span class="method-name">is_notify_writable</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="is-notify-writable-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 244</span>
244:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">is_notify_writable</span> <span class="ruby-identifier">sig</span>
245:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">isNotifyWritable</span>(<span class="ruby-identifier">sig</span>)
246:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="kqueue-method" class="method-detail ">
				<a name="M000295"></a>

				<div class="method-heading">
				
					<span class="method-name">kqueue</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="kqueue-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">kqueue</span>
153:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="kqueue--method" class="method-detail ">
				<a name="M000296"></a>

				<div class="method-heading">
				
					<span class="method-name">kqueue=</span><span
						class="method-args">(val)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="kqueue--source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 154</span>
154:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">kqueue=</span> <span class="ruby-identifier">val</span>
155:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="kqueue--method" class="method-detail ">
				<a name="M000298"></a>

				<div class="method-heading">
				
					<span class="method-name">kqueue?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="kqueue--source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">kqueue?</span>
160:     <span class="ruby-keyword kw">false</span>
161:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="library-type-method" class="method-detail ">
				<a name="M000305"></a>

				<div class="method-heading">
				
					<span class="method-name">library_type</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="library-type-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">library_type</span>
185:     <span class="ruby-value">:java</span>
186:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="library-type-method" class="method-detail ">
				<a name="M000315"></a>

				<div class="method-heading">
				
					<span class="method-name">library_type</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This is mostly useful for automated tests. Return a distinctive symbol so
the caller knows whether he&#8217;s dealing with an extension or with a
pure-Ruby library.
</p>
					

					
					<div class="method-source-code"
						id="library-type-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 45</span>
45:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">library_type</span>
46:       <span class="ruby-value">:pure_ruby</span>
47:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="next-tick-method" class="method-detail ">
				<a name="M000256"></a>

				<div class="method-heading">
				
					<span class="method-name">next_tick</span><span
						class="method-args">(pr=nil, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Schedules a proc for execution immediately after the next
&#8220;turn&#8221; through the reactor core. An advanced technique, this
can be useful for improving memory management and/or application
responsiveness, especially when scheduling large amounts of data for
writing to a network connection. TODO, we need a FAQ entry on this subject.
</p>
<p>
<a href="EventMachine.html#M000256">next_tick</a> takes either a single
argument (which must be a Proc) or a block.
</p>
					

					
					<div class="method-source-code"
						id="next-tick-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1092</span>
1092:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">next_tick</span> <span class="ruby-identifier">pr</span>=<span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">block</span>
1093:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;no proc or block given&quot;</span> <span class="ruby-keyword kw">unless</span> ((<span class="ruby-identifier">pr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pr</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>)) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">block</span>)
1094:     <span class="ruby-ivar">@next_tick_mutex</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword kw">do</span>
1095:       (<span class="ruby-ivar">@next_tick_queue</span> <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> ( <span class="ruby-identifier">pr</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span> )
1096:     <span class="ruby-keyword kw">end</span>
1097:     <span class="ruby-identifier">signal_loopbreak</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reactor_running?</span>
1098:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-datagram-socket-method" class="method-detail ">
				<a name="M000248"></a>

				<div class="method-heading">
				
					<span class="method-name">open_datagram_socket</span><span
						class="method-args">(address, port, handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000248">EventMachine#open_datagram_socket</a>
is for support of UDP-based protocols. Its usage is similar to that of <a
href="EventMachine.html#M000238">EventMachine#start_server</a>. It takes
three parameters: an IP address (which must be valid on the machine which
executes the method), a port number, and an optional Module name which will
handle the data. This method will create a new UDP (datagram) socket and
bind it to the address and port that you specify. The normal callbacks (see
<a href="EventMachine.html#M000238">EventMachine#start_server</a>) will be
called as events of interest occur on the newly-created socket, but there
are some differences in how they behave.
</p>
<p>
<a href="EventMachine/Connection.html#M000035">Connection#receive_data</a>
will be called when a datagram packet is received on the socket, but unlike
TCP sockets, the message boundaries of the received data will be respected.
In other words, if the remote peer sent you a datagram of a particular
size, you may rely on <a
href="EventMachine/Connection.html#M000035">Connection#receive_data</a> to
give you the exact data in the packet, with the original data length. Also
observe that <a
href="EventMachine/Connection.html#M000035">Connection#receive_data</a> may
be called with a <em>zero-length</em> data payload, since empty datagrams
are permitted in UDP.
</p>
<p>
<a href="EventMachine/Connection.html#M000046">Connection#send_data</a> is
available with UDP packets as with TCP, but there is an important
difference. Because UDP communications are <em>connectionless,</em> there
is no implicit recipient for the packets you send. Ordinarily you must
specify the recipient for each packet you send. However, <a
href="EventMachine.html">EventMachine</a> provides for the typical pattern
of receiving a UDP datagram from a remote peer, performing some operation,
and then sending one or more packets in response to the same remote peer.
To support this model easily, just use <a
href="EventMachine/Connection.html#M000046">Connection#send_data</a> in the
code that you supply for Connection:receive_data. <a
href="EventMachine.html">EventMachine</a> will provide an implicit return
address for any messages sent to <a
href="EventMachine/Connection.html#M000046">Connection#send_data</a> within
the context of a <a
href="EventMachine/Connection.html#M000035">Connection#receive_data</a>
callback, and your response will automatically go to the correct remote
peer. (TODO: Example-code needed!)
</p>
<p>
Observe that the port number that you supply to <a
href="EventMachine.html#M000248">EventMachine#open_datagram_socket</a> may
be zero. In this case, <a href="EventMachine.html">EventMachine</a> will
create a UDP socket that is bound to an <em>ephemeral</em> (not well-known)
port. This is not appropriate for servers that must publish a well-known
port to which remote peers may send datagrams. But it can be useful for
clients that send datagrams to other servers. If you do this, you will
receive any responses from the remote servers through the normal <a
href="EventMachine/Connection.html#M000035">Connection#receive_data</a>
callback. Observe that you will probably have issues with firewalls
blocking the ephemeral port numbers, so this technique is most appropriate
for LANs. (TODO: Need an example!)
</p>
<p>
If you wish to send datagrams to arbitrary remote peers (not necessarily
ones that have sent data to which you are responding), then see <a
href="EventMachine/Connection.html#M000051">Connection#send_datagram</a>.
</p>
<p>
DO NOT call <a href="EventMachine.html#M000283">send_data</a> from a
datagram socket outside of a receive_data method. Use <a
href="EventMachine.html#M000284">send_datagram</a>. If you do use <a
href="EventMachine.html#M000283">send_data</a> outside of a receive_data
method, you&#8217;ll get a confusing error because there is no
&#8220;peer,&#8221; as <a href="EventMachine.html#M000283">send_data</a>
requires. (Inside of receive_data, <a
href="EventMachine.html#M000283">send_data</a> &#8220;fakes&#8221; the peer
as described above.)
</p>
					

					
					<div class="method-source-code"
						id="open-datagram-socket-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 913</span>
913:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open_datagram_socket</span> <span class="ruby-identifier">address</span>, <span class="ruby-identifier">port</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>
914:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
915:     <span class="ruby-identifier">s</span> = <span class="ruby-identifier">open_udp_socket</span> <span class="ruby-identifier">address</span>, <span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span>
916:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
917:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
918:     <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span>
919:     <span class="ruby-identifier">c</span>
920:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-keyboard-method" class="method-detail ">
				<a name="M000261"></a>

				<div class="method-heading">
				
					<span class="method-name">open_keyboard</span><span
						class="method-args">(handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
(Experimental)
</p>
					

					
					<div class="method-source-code"
						id="open-keyboard-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1191</span>
1191:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open_keyboard</span> <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>
1192:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
1193: 
1194:     <span class="ruby-identifier">s</span> = <span class="ruby-identifier">read_keyboard</span>
1195:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
1196:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
1197:     <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span>
1198:     <span class="ruby-identifier">c</span>
1199:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-udp-socket-method" class="method-detail ">
				<a name="M000300"></a>

				<div class="method-heading">
				
					<span class="method-name">open_udp_socket</span><span
						class="method-args">(server, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="open-udp-socket-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 165</span>
165:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open_udp_socket</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
166:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">openUdpSocket</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
167:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-udp-socket-method" class="method-detail ">
				<a name="M000331"></a>

				<div class="method-heading">
				
					<span class="method-name">open_udp_socket</span><span
						class="method-args">(host, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000300">open_udp_socket</a>
</p>
					

					
					<div class="method-source-code"
						id="open-udp-socket-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 136</span>
136:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open_udp_socket</span> <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
137:       <span class="ruby-constant">EvmaUDPSocket</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>).<span class="ruby-identifier">uuid</span>
138:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="popen-method" class="method-detail ">
				<a name="M000259"></a>

				<div class="method-heading">
				
					<span class="method-name">popen</span><span
						class="method-args">(cmd, handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Run an external process. This does not currently work on Windows.
</p>
<pre>
 module RubyCounter
   def post_init
     # count up to 5
     send_data &quot;5\n&quot;
   end
   def receive_data data
     puts &quot;ruby sent me: #{data}&quot;
   end
   def unbind
     puts &quot;ruby died with exit status: #{get_status.exitstatus}&quot;
   end
 end

 EM.run{
   EM.popen(&quot;ruby -e' $stdout.sync = true; gets.to_i.times{ |i| puts i+1; sleep 1 } '&quot;, RubyCounter)
 }
</pre>
<p>
Also see <a
href="EventMachine/DeferrableChildProcess.html">EventMachine::DeferrableChildProcess</a>
and <a href="EventMachine.html#M000097">EventMachine.system</a>
</p>
					

					
					<div class="method-source-code"
						id="popen-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1161</span>
1161:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">popen</span> <span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>
1162:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
1163:     <span class="ruby-identifier">w</span> = <span class="ruby-constant">Shellwords</span><span class="ruby-operator">::</span><span class="ruby-identifier">shellwords</span>( <span class="ruby-identifier">cmd</span> )
1164:     <span class="ruby-identifier">w</span>.<span class="ruby-identifier">unshift</span>( <span class="ruby-identifier">w</span>.<span class="ruby-identifier">first</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">first</span>
1165:     <span class="ruby-identifier">s</span> = <span class="ruby-identifier">invoke_popen</span>( <span class="ruby-identifier">w</span> )
1166:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
1167:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
1168:     <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">c</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
1169:     <span class="ruby-identifier">c</span>
1170:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="reactor-running--method" class="method-detail ">
				<a name="M000260"></a>

				<div class="method-heading">
				
					<span class="method-name">reactor_running?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Tells you whether the <a href="EventMachine.html">EventMachine</a> reactor
loop is currently running. Returns true or false. Useful when writing
libraries that want to run event-driven code, but may be running in
programs that are already event-driven. In such cases, if <a
href="EventMachine.html#M000260">EventMachine#reactor_running?</a> returns
false, your code can invoke <a
href="EventMachine.html#M000229">EventMachine#run</a> and run your
application code inside the block passed to that method. If <a
href="EventMachine.html#M000260">EventMachine#reactor_running?</a> returns
true, just execute your event-aware code.
</p>
<p>
This method is necessary because calling <a
href="EventMachine.html#M000229">EventMachine#run</a> inside of another
call to <a href="EventMachine.html#M000229">EventMachine#run</a> generates
a fatal error.
</p>
					

					
					<div class="method-source-code"
						id="reactor-running--source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1183</span>
1183:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reactor_running?</span>
1184:     (<span class="ruby-ivar">@reactor_running</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">false</span>)
1185:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="reactor-thread--method" class="method-detail ">
				<a name="M000231"></a>

				<div class="method-heading">
				
					<span class="method-name">reactor_thread?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns true if the calling thread is the same thread as the reactor.
</p>
					

					
					<div class="method-source-code"
						id="reactor-thread--source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 301</span>
301:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reactor_thread?</span>
302:     <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@reactor_thread</span>
303:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="read-keyboard-method" class="method-detail ">
				<a name="M000340"></a>

				<div class="method-heading">
				
					<span class="method-name">read_keyboard</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000302">read_keyboard</a>
</p>
					

					
					<div class="method-source-code"
						id="read-keyboard-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 197</span>
197:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_keyboard</span>
198:       <span class="ruby-constant">EvmaKeyboard</span>.<span class="ruby-identifier">open</span>.<span class="ruby-identifier">uuid</span>
199:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="read-keyboard-method" class="method-detail ">
				<a name="M000302"></a>

				<div class="method-heading">
				
					<span class="method-name">read_keyboard</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="read-keyboard-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read_keyboard</span>
173:     <span class="ruby-comment cmt"># TEMPORARILY unsupported until someone figures out how to do it.</span>
174:     <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;temporarily unsupported on this platform&quot;</span>
175:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="release-machine-method" class="method-detail ">
				<a name="M000276"></a>

				<div class="method-heading">
				
					<span class="method-name">release_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="release-machine-source">
<pre>
    <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">release_machine</span>
95:     <span class="ruby-ivar">@em</span> = <span class="ruby-keyword kw">nil</span>
96:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="release-machine-method" class="method-detail ">
				<a name="M000319"></a>

				<div class="method-heading">
				
					<span class="method-name">release_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
release_machine. Probably a no-op.
</p>
					

					
					<div class="method-source-code"
						id="release-machine-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 68</span>
68:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">release_machine</span>
69:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-method" class="method-detail ">
				<a name="M000229"></a>

				<div class="method-heading">
				
					<span class="method-name">run</span><span
						class="method-args">(blk=nil, tail=nil, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine::run initializes and runs an event loop. This method only
returns if user-callback code calls stop_event_loop. Use the supplied block
to define your clients and servers. The block is called by
EventMachine::run immediately after initializing its internal event loop
but <em>before</em> running the loop. Therefore this block is the right
place to call <a href="EventMachine.html#M000238">start_server</a> if you
want to accept connections from remote clients.
</p>
<p>
For programs that are structured as servers, it&#8217;s usually appropriate
to start an event loop by calling EventMachine::run, and let it run
forever. It&#8217;s also possible to use EventMachine::run to make a single
client-connection to a remote server, process the data flow from that
single connection, and then call <a
href="EventMachine.html#M000237">stop_event_loop</a> to force
EventMachine::run to return. Your program will then continue from the point
immediately following the call to EventMachine::run.
</p>
<p>
You can of course do both client and servers simultaneously in the same
program. One of the strengths of the event-driven programming model is that
the handling of network events on many different connections will be
interleaved, and scheduled according to the actual events themselves. This
maximizes efficiency.
</p>
<h3>Server usage example</h3>
<p>
See <a href="EventMachine.html#M000238">EventMachine.start_server</a>
</p>
<h3>Client usage example</h3>
<p>
See <a href="EventMachine.html#M000241">EventMachine.connect</a>
</p>
					

					
					<div class="method-source-code"
						id="run-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 236</span>
236:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">blk</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">tail</span>=<span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">block</span>
237:     <span class="ruby-ivar">@tails</span> <span class="ruby-operator">||=</span> []
238:     <span class="ruby-identifier">tail</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@tails</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">tail</span>)
239: 
240:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reactor_running?</span>
241:       (<span class="ruby-identifier">b</span> = <span class="ruby-identifier">blk</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">call</span> <span class="ruby-comment cmt"># next_tick(b)</span>
242:     <span class="ruby-keyword kw">else</span>
243:       <span class="ruby-ivar">@conns</span> = {}
244:       <span class="ruby-ivar">@acceptors</span> = {}
245:       <span class="ruby-ivar">@timers</span> = {}
246:       <span class="ruby-ivar">@wrapped_exception</span> = <span class="ruby-keyword kw">nil</span>
247:       <span class="ruby-ivar">@next_tick_queue</span> <span class="ruby-operator">||=</span> []
248:       <span class="ruby-keyword kw">begin</span>
249:         <span class="ruby-ivar">@reactor_running</span> = <span class="ruby-keyword kw">true</span>
250:         <span class="ruby-identifier">initialize_event_machine</span>
251:         (<span class="ruby-identifier">b</span> = <span class="ruby-identifier">blk</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">add_timer</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">b</span>)
252:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@next_tick_queue</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@next_tick_queue</span>.<span class="ruby-identifier">empty?</span>
253:           <span class="ruby-identifier">add_timer</span>(<span class="ruby-value">0</span>) { <span class="ruby-identifier">signal_loopbreak</span> }
254:         <span class="ruby-keyword kw">end</span>
255:         <span class="ruby-ivar">@reactor_thread</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>
256:         <span class="ruby-identifier">run_machine</span>
257:       <span class="ruby-keyword kw">ensure</span>
258:         <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@tails</span>.<span class="ruby-identifier">empty?</span>
259:           <span class="ruby-ivar">@tails</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">call</span>
260:         <span class="ruby-keyword kw">end</span>
261: 
262:         <span class="ruby-keyword kw">begin</span>
263:           <span class="ruby-identifier">release_machine</span>
264:         <span class="ruby-keyword kw">ensure</span>
265:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@threadpool</span>
266:             <span class="ruby-ivar">@threadpool</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">exit</span> }
267:             <span class="ruby-ivar">@threadpool</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
268:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">alive?</span>
269:               <span class="ruby-comment cmt"># ruby 1.9 has no kill!</span>
270:               <span class="ruby-identifier">t</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:kill!</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">kill!</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">kill</span>
271:             <span class="ruby-keyword kw">end</span>
272:             <span class="ruby-ivar">@threadqueue</span> = <span class="ruby-keyword kw">nil</span>
273:             <span class="ruby-ivar">@resultqueue</span> = <span class="ruby-keyword kw">nil</span>
274:             <span class="ruby-ivar">@threadpool</span> = <span class="ruby-keyword kw">nil</span>
275:           <span class="ruby-keyword kw">end</span>
276: 
277:           <span class="ruby-ivar">@next_tick_queue</span> = <span class="ruby-keyword kw">nil</span>
278:         <span class="ruby-keyword kw">end</span>
279:         <span class="ruby-ivar">@reactor_running</span> = <span class="ruby-keyword kw">false</span>
280:         <span class="ruby-ivar">@reactor_thread</span> = <span class="ruby-keyword kw">nil</span>
281:       <span class="ruby-keyword kw">end</span>
282: 
283:       <span class="ruby-identifier">raise</span> <span class="ruby-ivar">@wrapped_exception</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@wrapped_exception</span>
284:     <span class="ruby-keyword kw">end</span>
285:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-block-method" class="method-detail ">
				<a name="M000230"></a>

				<div class="method-heading">
				
					<span class="method-name">run_block</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sugars a common use case. Will pass the given block to <a
href="EventMachine.html#M000229">run</a>, but will terminate the reactor
loop and exit the function as soon as the code in the block completes.
(Normally, <a href="EventMachine.html#M000229">run</a> keeps running
indefinitely, even after the block supplied to it finishes running, until
user code calls <a href="EventMachine.html#M000279">stop</a>.)
</p>
					

					
					<div class="method-source-code"
						id="run-block-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 292</span>
292:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run_block</span> &amp;<span class="ruby-identifier">block</span>
293:     <span class="ruby-identifier">pr</span> = <span class="ruby-identifier">proc</span> {
294:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>
295:       <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">stop</span>
296:     }
297:     <span class="ruby-identifier">run</span>(&amp;<span class="ruby-identifier">pr</span>)
298:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-machine-method" class="method-detail ">
				<a name="M000318"></a>

				<div class="method-heading">
				
					<span class="method-name">run_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000278">run_machine</a>
</p>
					

					
					<div class="method-source-code"
						id="run-machine-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 63</span>
63:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run_machine</span>
64:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">run</span>
65:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-machine-method" class="method-detail ">
				<a name="M000278"></a>

				<div class="method-heading">
				
					<span class="method-name">run_machine</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="run-machine-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 100</span>
100:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run_machine</span>
101:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">run</span>
102:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="schedule-method" class="method-detail ">
				<a name="M000232"></a>

				<div class="method-heading">
				
					<span class="method-name">schedule</span><span
						class="method-args">(*a, &b)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Runs the given callback on the reactor thread, or immediately if called
from the reactor thread. Accepts the same arguments as EM::Callback
</p>
					

					
					<div class="method-source-code"
						id="schedule-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 307</span>
307:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">schedule</span>(*<span class="ruby-identifier">a</span>, &amp;<span class="ruby-identifier">b</span>)
308:     <span class="ruby-identifier">cb</span> = <span class="ruby-constant">Callback</span>(*<span class="ruby-identifier">a</span>, &amp;<span class="ruby-identifier">b</span>)
309:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reactor_running?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">reactor_thread?</span>
310:       <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>
311:     <span class="ruby-keyword kw">else</span>
312:       <span class="ruby-identifier">next_tick</span> { <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span> }
313:     <span class="ruby-keyword kw">end</span>
314:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="send-data-method" class="method-detail ">
				<a name="M000323"></a>

				<div class="method-heading">
				
					<span class="method-name">send_data</span><span
						class="method-args">(target, data, datalength)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000283">send_data</a>
</p>
					

					
					<div class="method-source-code"
						id="send-data-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 87</span>
87:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_data</span> <span class="ruby-identifier">target</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">datalength</span>
88:       <span class="ruby-identifier">selectable</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">target</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown send_data target&quot;</span>
89:       <span class="ruby-identifier">selectable</span>.<span class="ruby-identifier">send_data</span> <span class="ruby-identifier">data</span>
90:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="send-data-method" class="method-detail ">
				<a name="M000283"></a>

				<div class="method-heading">
				
					<span class="method-name">send_data</span><span
						class="method-args">(sig, data, length)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="send-data-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send_data</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">length</span>
117:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">sendData</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_java_bytes</span>
118:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="send-datagram-method" class="method-detail ">
				<a name="M000284"></a>

				<div class="method-heading">
				
					<span class="method-name">send_datagram</span><span
						class="method-args">(sig, data, length, address, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="send-datagram-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 119</span>
119:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send_datagram</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">length</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">port</span>
120:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">sendDatagram</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">length</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">port</span>
121:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="send-datagram-method" class="method-detail ">
				<a name="M000332"></a>

				<div class="method-heading">
				
					<span class="method-name">send_datagram</span><span
						class="method-args">(target, data, datalength, host, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000284">send_datagram</a>. This is currently
only for UDP! We need to make it work with unix-domain sockets as well.
</p>
					

					
					<div class="method-source-code"
						id="send-datagram-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 142</span>
142:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_datagram</span> <span class="ruby-identifier">target</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">datalength</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
143:       <span class="ruby-identifier">selectable</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">target</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown send_data target&quot;</span>
144:       <span class="ruby-identifier">selectable</span>.<span class="ruby-identifier">send_datagram</span> <span class="ruby-identifier">data</span>, <span class="ruby-constant">Socket</span><span class="ruby-operator">::</span><span class="ruby-identifier">pack_sockaddr_in</span>(<span class="ruby-identifier">port</span>, <span class="ruby-identifier">host</span>)
145:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="send-file-data-method" class="method-detail ">
				<a name="M000338"></a>

				<div class="method-heading">
				
					<span class="method-name">send_file_data</span><span
						class="method-args">(sig, filename)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000338">send_file_data</a>
</p>
					

					
					<div class="method-source-code"
						id="send-file-data-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_file_data</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">filename</span>
177:       <span class="ruby-identifier">sz</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">size</span>(<span class="ruby-identifier">filename</span>)
178:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;file too large&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sz</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">32</span>*<span class="ruby-value">1024</span>
179:       <span class="ruby-identifier">data</span> =
180:       <span class="ruby-keyword kw">begin</span>
181:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">filename</span>
182:       <span class="ruby-keyword kw">rescue</span>
183:         <span class="ruby-value str">&quot;&quot;</span>
184:       <span class="ruby-keyword kw">end</span>
185:       <span class="ruby-identifier">send_data</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>
186:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-comm-inactivity-timeout-method" class="method-detail ">
				<a name="M000288"></a>

				<div class="method-heading">
				
					<span class="method-name">set_comm_inactivity_timeout</span><span
						class="method-args">(sig, interval)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-comm-inactivity-timeout-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 131</span>
131:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_comm_inactivity_timeout</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">interval</span>
132:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">setCommInactivityTimeout</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">interval</span>
133:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-comm-inactivity-timeout-method" class="method-detail ">
				<a name="M000341"></a>

				<div class="method-heading">
				
					<span class="method-name">set_comm_inactivity_timeout</span><span
						class="method-args">(sig, tm)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000288">set_comm_inactivity_timeout</a>
</p>
					

					
					<div class="method-source-code"
						id="set-comm-inactivity-timeout-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 203</span>
203:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_comm_inactivity_timeout</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">tm</span>
204:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>( <span class="ruby-identifier">sig</span> ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unknown set_comm_inactivity_timeout target&quot;</span>
205:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">set_inactivity_timeout</span> <span class="ruby-identifier">tm</span>
206:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-descriptor-table-size-method" class="method-detail ">
				<a name="M000258"></a>

				<div class="method-heading">
				
					<span class="method-name">set_descriptor_table_size</span><span
						class="method-args">(n_descriptors=nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the maximum number of file or socket descriptors that your process may
open. You can pass this method an integer specifying the new size of the
descriptor table. Returns the new descriptor-table size, which may be less
than the number you requested. If you call this method with no arguments,
it will simply return the current size of the descriptor table without
attempting to change it.
</p>
<p>
The new limit on open descriptors ONLY applies to sockets and other
descriptors that belong to <a href="EventMachine.html">EventMachine</a>. It
has NO EFFECT on the number of descriptors you can create in ordinary Ruby
code.
</p>
<p>
Not available on all platforms. Increasing the number of descriptors beyond
its default limit usually requires superuser privileges. (See <a
href="EventMachine.html#M000257">set_effective_user</a> for a way to drop
superuser privileges while your program is running.)
</p>
					

					
					<div class="method-source-code"
						id="set-descriptor-table-size-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1131</span>
1131:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_descriptor_table_size</span> <span class="ruby-identifier">n_descriptors</span>=<span class="ruby-keyword kw">nil</span>
1132:     <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">set_rlimit_nofile</span> <span class="ruby-identifier">n_descriptors</span>
1133:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-effective-user-method" class="method-detail ">
				<a name="M000257"></a>

				<div class="method-heading">
				
					<span class="method-name">set_effective_user</span><span
						class="method-args">(username)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
A wrapper over the setuid system call. Particularly useful when opening a
network server on a privileged port because you can use this call to drop
privileges after opening the port. Also very useful after a call to <a
href="EventMachine.html#M000258">set_descriptor_table_size</a>, which
generally requires that you start your process with root privileges.
</p>
<p>
This method has no effective implementation on Windows or in the pure-Ruby
implementation of <a href="EventMachine.html">EventMachine</a>. Call <a
href="EventMachine.html#M000257">set_effective_user</a> by passing it a
string containing the effective name of the user whose privilege-level your
process should attain. This method is intended for use in enforcing
security requirements, consequently it will throw a fatal error and end
your program if it fails.
</p>
					

					
					<div class="method-source-code"
						id="set-effective-user-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1112</span>
1112:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_effective_user</span> <span class="ruby-identifier">username</span>
1113:     <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">setuid_string</span> <span class="ruby-identifier">username</span>
1114:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-max-timer-count-method" class="method-detail ">
				<a name="M000303"></a>

				<div class="method-heading">
				
					<span class="method-name">set_max_timer_count</span><span
						class="method-args">(num)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-max-timer-count-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 176</span>
176:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_max_timer_count</span> <span class="ruby-identifier">num</span>
177:     <span class="ruby-comment cmt"># harmless no-op in Java. There's no built-in timer limit.</span>
178:     <span class="ruby-ivar">@max_timer_count</span> = <span class="ruby-identifier">num</span>
179:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-max-timer-count-method" class="method-detail ">
				<a name="M000337"></a>

				<div class="method-heading">
				
					<span class="method-name">set_max_timer_count</span><span
						class="method-args">(n)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000303">set_max_timer_count</a> is a harmless
no-op in pure Ruby, which doesn&#8217;t have a built-in limit on the number
of available timers.
</p>
					

					
					<div class="method-source-code"
						id="set-max-timer-count-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 172</span>
172:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_max_timer_count</span> <span class="ruby-identifier">n</span>
173:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-max-timers-method" class="method-detail ">
				<a name="M000250"></a>

				<div class="method-heading">
				
					<span class="method-name">set_max_timers</span><span
						class="method-args">(ct)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the maximum number of timers and periodic timers that may be
outstanding at any given time. You only need to call <a
href="EventMachine.html#M000250">set_max_timers</a> if you need more than
the default number of timers, which on most platforms is 1000. Call this
method before calling <a
href="EventMachine.html#M000229">EventMachine#run</a>.
</p>
					

					
					<div class="method-source-code"
						id="set-max-timers-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 944</span>
944:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_max_timers</span> <span class="ruby-identifier">ct</span>
945:     <span class="ruby-identifier">set_max_timer_count</span> <span class="ruby-identifier">ct</span>
946:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-notify-readable-method" class="method-detail ">
				<a name="M000309"></a>

				<div class="method-heading">
				
					<span class="method-name">set_notify_readable</span><span
						class="method-args">(sig, mode)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-notify-readable-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 234</span>
234:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_notify_readable</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">mode</span>
235:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">setNotifyReadable</span>(<span class="ruby-identifier">sig</span>, <span class="ruby-identifier">mode</span>)
236:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-notify-writable-method" class="method-detail ">
				<a name="M000310"></a>

				<div class="method-heading">
				
					<span class="method-name">set_notify_writable</span><span
						class="method-args">(sig, mode)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-notify-writable-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 237</span>
237:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_notify_writable</span> <span class="ruby-identifier">sig</span>, <span class="ruby-identifier">mode</span>
238:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">setNotifyWritable</span>(<span class="ruby-identifier">sig</span>, <span class="ruby-identifier">mode</span>)
239:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-quantum-method" class="method-detail ">
				<a name="M000249"></a>

				<div class="method-heading">
				
					<span class="method-name">set_quantum</span><span
						class="method-args">(mills)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
For advanced users. This function sets the default timer granularity, which
by default is slightly smaller than 100 milliseconds. Call this function to
set a higher or lower granularity. The function affects the behavior of <a
href="EventMachine.html#M000234">add_timer</a> and <a
href="EventMachine.html#M000235">add_periodic_timer</a>. Most applications
will not need to call this function.
</p>
<p>
The argument is a number of milliseconds. Avoid setting the quantum to very
low values because that may reduce performance under some extreme
conditions. We recommend that you not set a quantum lower than 10.
</p>
<p>
You may only call this function while an <a
href="EventMachine.html">EventMachine</a> loop is running (that is, after a
call to <a href="EventMachine.html#M000229">EventMachine#run</a> and before
a subsequent call to <a
href="EventMachine.html#M000279">EventMachine#stop</a>).
</p>
					

					
					<div class="method-source-code"
						id="set-quantum-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 935</span>
935:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_quantum</span> <span class="ruby-identifier">mills</span>
936:     <span class="ruby-identifier">set_timer_quantum</span> <span class="ruby-identifier">mills</span>.<span class="ruby-identifier">to_i</span>
937:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-rlimit-nofile-method" class="method-detail ">
				<a name="M000299"></a>

				<div class="method-heading">
				
					<span class="method-name">set_rlimit_nofile</span><span
						class="method-args">(n_descriptors)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-rlimit-nofile-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 162</span>
162:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_rlimit_nofile</span> <span class="ruby-identifier">n_descriptors</span>
163:     <span class="ruby-comment cmt"># Currently a no-op for Java.</span>
164:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-rlimit-nofile-method" class="method-detail ">
				<a name="M000336"></a>

				<div class="method-heading">
				
					<span class="method-name">set_rlimit_nofile</span><span
						class="method-args">(n)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000299">set_rlimit_nofile</a> is a no-op in the
pure-Ruby implementation. We simply return Ruby&#8217;s built-in
per-process file-descriptor limit.
</p>
					

					
					<div class="method-source-code"
						id="set-rlimit-nofile-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 166</span>
166:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_rlimit_nofile</span> <span class="ruby-identifier">n</span>
167:       <span class="ruby-value">1024</span>
168:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-timer-quantum-method" class="method-detail ">
				<a name="M000333"></a>

				<div class="method-heading">
				
					<span class="method-name">set_timer_quantum</span><span
						class="method-args">(interval)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000292">set_timer_quantum</a> in milliseconds.
The underlying <a href="EventMachine/Reactor.html">Reactor</a> function
wants a (possibly fractional) number of seconds.
</p>
					

					
					<div class="method-source-code"
						id="set-timer-quantum-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_timer_quantum</span> <span class="ruby-identifier">interval</span>
151:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">set_timer_quantum</span>(( <span class="ruby-value">1.0</span> * <span class="ruby-identifier">interval</span>) <span class="ruby-operator">/</span> <span class="ruby-value">1000.0</span>)
152:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="set-timer-quantum-method" class="method-detail ">
				<a name="M000292"></a>

				<div class="method-heading">
				
					<span class="method-name">set_timer_quantum</span><span
						class="method-args">(q)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="set-timer-quantum-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_timer_quantum</span> <span class="ruby-identifier">q</span>
144:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">setTimerQuantum</span> <span class="ruby-identifier">q</span>
145:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="signal-loopbreak-method" class="method-detail ">
				<a name="M000329"></a>

				<div class="method-heading">
				
					<span class="method-name">signal_loopbreak</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000291">signal_loopbreak</a>
</p>
					

					
					<div class="method-source-code"
						id="signal-loopbreak-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 125</span>
125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">signal_loopbreak</span>
126:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">signal_loopbreak</span>
127:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="signal-loopbreak-method" class="method-detail ">
				<a name="M000291"></a>

				<div class="method-heading">
				
					<span class="method-name">signal_loopbreak</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="signal-loopbreak-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 140</span>
140:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">signal_loopbreak</span>
141:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">signalLoopbreak</span>
142:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="spawn-method" class="method-detail ">
				<a name="M000215"></a>

				<div class="method-heading">
				
					<span class="method-name">spawn</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Spawn an erlang-style process
</p>
					

					
					<div class="method-source-code"
						id="spawn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/em/spawnable.rb, line 72</span>
72:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">spawn</span> &amp;<span class="ruby-identifier">block</span>
73:     <span class="ruby-identifier">s</span> = <span class="ruby-constant">SpawnedProcess</span>.<span class="ruby-identifier">new</span>
74:     <span class="ruby-identifier">s</span>.<span class="ruby-identifier">set_receiver</span> <span class="ruby-identifier">block</span>
75:     <span class="ruby-identifier">s</span>
76:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="ssl--method" class="method-detail ">
				<a name="M000290"></a>

				<div class="method-heading">
				
					<span class="method-name">ssl?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="ssl--source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ssl?</span>
138:     <span class="ruby-keyword kw">false</span>
139:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="ssl--method" class="method-detail ">
				<a name="M000335"></a>

				<div class="method-heading">
				
					<span class="method-name">ssl?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
ssl? is not implemented for pure-Ruby implementation
</p>
					

					
					<div class="method-source-code"
						id="ssl--source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 160</span>
160:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ssl?</span>
161:       <span class="ruby-keyword kw">false</span>
162:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-server-method" class="method-detail ">
				<a name="M000238"></a>

				<div class="method-heading">
				
					<span class="method-name">start_server</span><span
						class="method-args">(server, port=nil, handler=nil, *args, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine::start_server initiates a TCP server (socket acceptor) on the
specified IP address and port. The IP address must be valid on the machine
where the program runs, and the process must be privileged enough to listen
on the specified port (on Unix-like systems, superuser privileges are
usually required to listen on any port lower than 1024). Only one listener
may be running on any given address/port combination. <a
href="EventMachine.html#M000238">start_server</a> will fail if the given
address and port are already listening on the machine, either because of a
prior call to <a href="EventMachine.html#M000238">start_server</a> or some
unrelated process running on the machine. If <a
href="EventMachine.html#M000238">start_server</a> succeeds, the new network
listener becomes active immediately and starts accepting connections from
remote peers, and these connections generate callback events that are
processed by the code specified in the handler parameter to start_server.
</p>
<p>
The optional handler which is passed to <a
href="EventMachine.html#M000238">start_server</a> is the key to
EventMachine&#8217;s ability to handle particular network protocols. The
handler parameter passed to <a
href="EventMachine.html#M000238">start_server</a> must be a Ruby Module
that you must define. When the network server that is started by <a
href="EventMachine.html#M000238">start_server</a> accepts a new connection,
it instantiates a new object of an anonymous class that is inherited from
<a href="EventMachine/Connection.html">EventMachine::Connection</a>,
<em>into which the methods from your handler have been mixed.</em> Your
handler module may redefine any of the methods in <a
href="EventMachine/Connection.html">EventMachine::Connection</a> in order
to implement the specific behavior of the network protocol.
</p>
<p>
Callbacks invoked in response to network events <em>always</em> take place
within the execution context of the object derived from <a
href="EventMachine/Connection.html">EventMachine::Connection</a> extended
by your handler module. There is one object per connection, and all of the
callbacks invoked for a particular connection take the form of instance
methods called against the corresponding <a
href="EventMachine/Connection.html">EventMachine::Connection</a> object.
Therefore, you are free to define whatever instance variables you wish, in
order to contain the per-connection state required by the network protocol
you are implementing.
</p>
<p>
<a href="EventMachine.html#M000238">start_server</a> is often called inside
the block passed to EventMachine::run, but it can be called from any <a
href="EventMachine.html">EventMachine</a> callback. <a
href="EventMachine.html#M000238">start_server</a> will fail unless the <a
href="EventMachine.html">EventMachine</a> event loop is currently running
(which is why it&#8217;s often called in the block suppled to
EventMachine::run).
</p>
<p>
You may call <a href="EventMachine.html#M000238">start_server</a> any
number of times to start up network listeners on different address/port
combinations. The servers will all run simultaneously. More interestingly,
each individual call to <a
href="EventMachine.html#M000238">start_server</a> can specify a different
handler module and thus implement a different network protocol from all the
others.
</p>
<h3>Usage example</h3>
<p>
Here is an example of a server that counts lines of input from the remote
peer and sends back the total number of lines received, after each line.
Try the example with more than one client connection opened via telnet, and
you will see that the line count increments independently on each of the
client connections. Also very important to note, is that the handler for
the receive_data function, which our handler redefines, may not assume that
the data it receives observes any kind of message boundaries. Also, to use
this example, be sure to change the server and port parameters to the <a
href="EventMachine.html#M000238">start_server</a> call to values
appropriate for your environment.
</p>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module LineCounter
   MaxLinesPerConnection = 10
 
   def post_init
     puts &quot;Received a new connection&quot;
     @data_received = &quot;&quot;
     @line_count = 0
   end
 
   def receive_data data
     @data_received &lt;&lt; data
     while @data_received.slice!( /^[^\n]*[\n]/m )
       @line_count += 1
       send_data &quot;received #{@line_count} lines so far\r\n&quot;
       @line_count == MaxLinesPerConnection and close_connection_after_writing
     end
   end
 end
 
 EventMachine::run {
   host,port = &quot;192.168.0.100&quot;, 8090
   EventMachine::start_server host, port, LineCounter
   puts &quot;Now accepting connections on address #{host}, port #{port}...&quot;
   EventMachine::add_periodic_timer( 10 ) { $stderr.write &quot;*&quot; }
 }
 </pre>
					

					
					<div class="method-source-code"
						id="start-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 558</span>
558:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">start_server</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>
559:     <span class="ruby-keyword kw">begin</span>
560:       <span class="ruby-identifier">port</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">port</span>)
561:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-constant">TypeError</span>
562:       <span class="ruby-comment cmt"># there was no port, so server must be a unix domain socket</span>
563:       <span class="ruby-comment cmt"># the port argument is actually the handler, and the handler is one of the args</span>
564:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">handler</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">handler</span>
565:       <span class="ruby-identifier">handler</span> = <span class="ruby-identifier">port</span>
566:       <span class="ruby-identifier">port</span> = <span class="ruby-keyword kw">nil</span>
567:     <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">port</span>
568: 
569:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">Connection</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
570: 
571:     <span class="ruby-identifier">s</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">port</span>
572:           <span class="ruby-identifier">start_tcp_server</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
573:         <span class="ruby-keyword kw">else</span>
574:           <span class="ruby-identifier">start_unix_server</span> <span class="ruby-identifier">server</span>
575:         <span class="ruby-keyword kw">end</span>
576:     <span class="ruby-ivar">@acceptors</span>[<span class="ruby-identifier">s</span>] = [<span class="ruby-identifier">klass</span>,<span class="ruby-identifier">args</span>,<span class="ruby-identifier">block</span>]
577:     <span class="ruby-identifier">s</span>
578:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-tcp-server-method" class="method-detail ">
				<a name="M000280"></a>

				<div class="method-heading">
				
					<span class="method-name">start_tcp_server</span><span
						class="method-args">(server, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="start-tcp-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">start_tcp_server</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
107:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">startTcpServer</span> <span class="ruby-identifier">server</span>, <span class="ruby-identifier">port</span>
108:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-tcp-server-method" class="method-detail ">
				<a name="M000325"></a>

				<div class="method-heading">
				
					<span class="method-name">start_tcp_server</span><span
						class="method-args">(host, port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000280">start_tcp_server</a>
</p>
					

					
					<div class="method-source-code"
						id="start-tcp-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 102</span>
102:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">start_tcp_server</span> <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>
103:       (<span class="ruby-identifier">s</span> = <span class="ruby-constant">EvmaTCPServer</span>.<span class="ruby-identifier">start_server</span> <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;no acceptor&quot;</span>
104:       <span class="ruby-identifier">s</span>.<span class="ruby-identifier">uuid</span>
105:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-tls-method" class="method-detail ">
				<a name="M000289"></a>

				<div class="method-heading">
				
					<span class="method-name">start_tls</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="start-tls-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">start_tls</span> <span class="ruby-identifier">sig</span>
135:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">startTls</span> <span class="ruby-identifier">sig</span>
136:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-unix-domain-server-method" class="method-detail ">
				<a name="M000240"></a>

				<div class="method-heading">
				
					<span class="method-name">start_unix_domain_server</span><span
						class="method-args">(filename, *args, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Start a Unix-domain server
</p>
<p>
Note that this is an alias for EventMachine::start_server, which can be
used to start both TCP and Unix-domain servers
</p>
					

					
					<div class="method-source-code"
						id="start-unix-domain-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 594</span>
594:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">start_unix_domain_server</span> <span class="ruby-identifier">filename</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>
595:     <span class="ruby-identifier">start_server</span> <span class="ruby-identifier">filename</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>
596:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-unix-server-method" class="method-detail ">
				<a name="M000327"></a>

				<div class="method-heading">
				
					<span class="method-name">start_unix_server</span><span
						class="method-args">(chain)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000282">start_unix_server</a>
</p>
					

					
					<div class="method-source-code"
						id="start-unix-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">start_unix_server</span> <span class="ruby-identifier">chain</span>
115:       (<span class="ruby-identifier">s</span> = <span class="ruby-constant">EvmaUNIXServer</span>.<span class="ruby-identifier">start_server</span> <span class="ruby-identifier">chain</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;no acceptor&quot;</span>
116:       <span class="ruby-identifier">s</span>.<span class="ruby-identifier">uuid</span>
117:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-unix-server-method" class="method-detail ">
				<a name="M000282"></a>

				<div class="method-heading">
				
					<span class="method-name">start_unix_server</span><span
						class="method-args">(filename)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="start-unix-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 112</span>
112:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">start_unix_server</span> <span class="ruby-identifier">filename</span>
113:     <span class="ruby-comment cmt"># TEMPORARILY unsupported until someone figures out how to do it.</span>
114:     <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;unsupported on this platform&quot;</span>
115:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-method" class="method-detail ">
				<a name="M000279"></a>

				<div class="method-heading">
				
					<span class="method-name">stop</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="stop-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stop</span>
104:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">stop</span>
105:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-method" class="method-detail ">
				<a name="M000320"></a>

				<div class="method-heading">
				
					<span class="method-name">stop</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
stop
</p>
					

					
					<div class="method-source-code"
						id="stop-source">
<pre>
    <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 72</span>
72:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop</span>
73:       <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">stop</span>
74:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-event-loop-method" class="method-detail ">
				<a name="M000237"></a>

				<div class="method-heading">
				
					<span class="method-name">stop_event_loop</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000237">stop_event_loop</a> may called from
within a callback method while EventMachine&#8217;s processing loop is
running. It causes the processing loop to stop executing, which will cause
all open connections and accepting servers to be run down and closed.
<em>Callbacks for connection-termination will be called</em> as part of the
processing of stop_event_loop. (There currently is no option to panic-stop
the loop without closing connections.) When all of this processing is
complete, the call to EventMachine::run which started the processing loop
will return and program flow will resume from the statement following
EventMachine::run call.
</p>
<h3>Usage example</h3>
<pre>
 require 'rubygems'
 require 'eventmachine'

 module Redmond
   def post_init
     puts &quot;We're sending a dumb HTTP request to the remote peer.&quot;
     send_data &quot;GET / HTTP/1.1\r\nHost: www.microsoft.com\r\n\r\n&quot;
   end
 
   def receive_data data
     puts &quot;We received #{data.length} bytes from the remote peer.&quot;
     puts &quot;We're going to stop the event loop now.&quot;
     EventMachine::stop_event_loop
   end
 
   def unbind
     puts &quot;A connection has terminated.&quot;
   end
 end
 
 puts &quot;We're starting the event loop now.&quot;
 EventMachine::run {
   EventMachine::connect &quot;www.microsoft.com&quot;, 80, Redmond
 }
 puts &quot;The event loop has stopped.&quot;
 
</pre>
<p>
This program will produce approximately the following output:
</p>
<pre>
 We're starting the event loop now.
 We're sending a dumb HTTP request to the remote peer.
 We received 1440 bytes from the remote peer.
 We're going to stop the event loop now.
 A connection has terminated.
 The event loop has stopped.</pre>
					

					
					<div class="method-source-code"
						id="stop-event-loop-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 468</span>
468:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stop_event_loop</span>
469:     <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">stop</span>
470:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-server-method" class="method-detail ">
				<a name="M000239"></a>

				<div class="method-heading">
				
					<span class="method-name">stop_server</span><span
						class="method-args">(signature)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Stop a TCP server socket that was started with <a
href="EventMachine.html#M000238">EventMachine#start_server</a>.
</p>
					

					
					<div class="method-source-code"
						id="stop-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 586</span>
586:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stop_server</span> <span class="ruby-identifier">signature</span>
587:     <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">stop_tcp_server</span> <span class="ruby-identifier">signature</span>
588:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-tcp-server-method" class="method-detail ">
				<a name="M000281"></a>

				<div class="method-heading">
				
					<span class="method-name">stop_tcp_server</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="stop-tcp-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/jeventmachine.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">stop_tcp_server</span> <span class="ruby-identifier">sig</span>
110:     <span class="ruby-ivar">@em</span>.<span class="ruby-identifier">stopTcpServer</span> <span class="ruby-identifier">sig</span>
111:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-tcp-server-method" class="method-detail ">
				<a name="M000326"></a>

				<div class="method-heading">
				
					<span class="method-name">stop_tcp_server</span><span
						class="method-args">(sig)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
<a href="EventMachine.html#M000281">stop_tcp_server</a>
</p>
					

					
					<div class="method-source-code"
						id="stop-tcp-server-source">
<pre>
     <span class="ruby-comment cmt"># File lib/pr_eventmachine.rb, line 108</span>
108:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop_tcp_server</span> <span class="ruby-identifier">sig</span>
109:       <span class="ruby-identifier">s</span> = <span class="ruby-constant">Reactor</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">get_selectable</span>(<span class="ruby-identifier">sig</span>)
110:       <span class="ruby-identifier">s</span>.<span class="ruby-identifier">schedule_close</span>
111:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="system-method" class="method-detail ">
				<a name="M000097"></a>

				<div class="method-heading">
				
					<span class="method-name">system</span><span
						class="method-args">(cmd, *args, &cb)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EM::system is a simple wrapper for EM::popen. It is similar to
Kernel::system, but requires a single string argument for the command and
performs no shell expansion.
</p>
<p>
The block or proc passed to EM::system is called with two arguments: the
output generated by the command, and a Process::Status that contains
information about the command&#8217;s execution.
</p>
<pre>
 EM.run{
   EM.system('ls'){ |output,status| puts output if status.exitstatus == 0 }
 }
</pre>
<p>
You can also supply an additional proc to send some data to the process:
</p>
<pre>
 EM.run{
   EM.system('sh', proc{ |process|
     process.send_data(&quot;echo hello\n&quot;)
     process.send_data(&quot;exit\n&quot;)
   }, proc{ |out,status|
     puts(out)
   })
 }
</pre>
<p>
Like <a href="EventMachine.html#M000259">EventMachine.popen</a>, <a
href="EventMachine.html#M000097">EventMachine.system</a> currently does not
work on windows. It returns the pid of the spawned process.
</p>
					

					
					<div class="method-source-code"
						id="system-source">
<pre>
     <span class="ruby-comment cmt"># File lib/em/processes.rb, line 108</span>
108:   <span class="ruby-keyword kw">def</span> <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">system</span> <span class="ruby-identifier">cmd</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">cb</span>
109:     <span class="ruby-identifier">cb</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Proc</span>
110:     <span class="ruby-identifier">init</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Proc</span>
111: 
112:     <span class="ruby-comment cmt"># merge remaining arguments into the command</span>
113:     <span class="ruby-identifier">cmd</span> = ([<span class="ruby-identifier">cmd</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span><span class="ruby-identifier">a</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">dump</span>}).<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)
114: 
115:     <span class="ruby-constant">EM</span>.<span class="ruby-identifier">get_subprocess_pid</span>(<span class="ruby-constant">EM</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-constant">SystemCmd</span>, <span class="ruby-identifier">cb</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
116:       <span class="ruby-identifier">init</span>[<span class="ruby-identifier">c</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">init</span>
117:     <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">signature</span>)
118:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="watch-method" class="method-detail ">
				<a name="M000243"></a>

				<div class="method-heading">
				
					<span class="method-name">watch</span><span
						class="method-args">(io, handler=nil, *args, &blk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine::watch registers a given file descriptor or <a
href="IO.html">IO</a> object with the eventloop. The file descriptor will
not be modified (it will remain blocking or non-blocking).
</p>
<p>
The eventloop can be used to process readable and writable events on the
file descriptor, using <a
href="EventMachine/Connection.html#M000065">EventMachine::Connection#notify_readable=</a>
and <a
href="EventMachine/Connection.html#M000067">EventMachine::Connection#notify_writable=</a>
</p>
<p>
<a
href="EventMachine/Connection.html#M000066">EventMachine::Connection#notify_readable?</a>
and <a
href="EventMachine/Connection.html#M000068">EventMachine::Connection#notify_writable?</a>
can be used to check what events are enabled on the connection.
</p>
<p>
To detach the file descriptor, use <a
href="EventMachine/Connection.html#M000043">EventMachine::Connection#detach</a>
</p>
<h3>Usage Example</h3>
<pre>
 module SimpleHttpClient
   def notify_readable
     header = @io.readline

     if header == &quot;\r\n&quot;
       # detach returns the file descriptor number (fd == @io.fileno)
       fd = detach
     end
   rescue EOFError
     detach
   end

   def unbind
     EM.next_tick do
       # socket is detached from the eventloop, but still open
       data = @io.read
     end
   end
 end

 EM.run{
   $sock = TCPSocket.new('site.com', 80)
   $sock.write(&quot;GET / HTTP/1.0\r\n\r\n&quot;)
   conn = EM.watch $sock, SimpleHttpClient
   conn.notify_readable = true
 }</pre>
					

					
					<div class="method-source-code"
						id="watch-source">
<pre>
     <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 768</span>
768:   <span class="ruby-keyword kw">def</span> <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-identifier">watch</span> <span class="ruby-identifier">io</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
769:     <span class="ruby-identifier">attach_io</span> <span class="ruby-identifier">io</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">blk</span>
770:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="watch-file-method" class="method-detail ">
				<a name="M000262"></a>

				<div class="method-heading">
				
					<span class="method-name">watch_file</span><span
						class="method-args">(filename, handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine&#8217;s file monitoring API. Currently supported are the
following events on individual files, using inotify on Linux systems, and
kqueue for OSX/BSD:
</p>
<ul>
<li><p>
File modified (written to)
</p>
</li>
<li><p>
File moved/renamed
</p>
</li>
<li><p>
File deleted
</p>
</li>
</ul>
<p>
EventMachine::watch_file takes a filename and a handler Module containing
your custom callback methods. This will setup the low level monitoring on
the specified file, and create a new <a
href="EventMachine/FileWatch.html">EventMachine::FileWatch</a> object with
your Module mixed in. <a href="EventMachine/FileWatch.html">FileWatch</a>
is a subclass of <a href="EventMachine/Connection.html">EM::Connection</a>,
so callbacks on this object work in the familiar way. The callbacks that
will be fired by <a href="EventMachine.html">EventMachine</a> are:
</p>
<ul>
<li><p>
file_modified
</p>
</li>
<li><p>
file_moved
</p>
</li>
<li><p>
file_deleted
</p>
</li>
</ul>
<p>
You can access the filename being monitored from within this object using
<a href="EventMachine/FileWatch.html#M000082">FileWatch#path</a>.
</p>
<p>
When a file is deleted, <a
href="EventMachine/FileWatch.html#M000086">FileWatch#stop_watching</a> will
be called after your file_deleted callback,  to clean up the underlying
monitoring and remove EventMachine&#8217;s reference to the now-useless <a
href="EventMachine/FileWatch.html">FileWatch</a>. This will in turn call
unbind, if you wish to use it.
</p>
<p>
The corresponding system-level Errno will be raised when attempting to
monitor non-existent files, files with wrong permissions, or if an error
occurs dealing with inotify/kqueue.
</p>
<h3>Usage example:</h3>
<pre>
 Make sure we have a file to monitor:
 $ echo &quot;bar&quot; &gt; /tmp/foo

 module Handler
   def file_modified
     puts &quot;#{path} modified&quot;
   end

   def file_moved
     puts &quot;#{path} moved&quot;
   end

   def file_deleted
     puts &quot;#{path} deleted&quot;
   end

   def unbind
     puts &quot;#{path} monitoring ceased&quot;
   end
 end

 EM.kqueue = true if EM.kqueue? # file watching requires kqueue on OSX

 EM.run {
   EM.watch_file(&quot;/tmp/foo&quot;, Handler)
 }

 $ echo &quot;baz&quot; &gt;&gt; /tmp/foo    =&gt;    &quot;/tmp/foo modified&quot;
 $ mv /tmp/foo /tmp/oof      =&gt;    &quot;/tmp/foo moved&quot;
 $ rm /tmp/oof               =&gt;    &quot;/tmp/foo deleted&quot;
                             =&gt;    &quot;/tmp/foo monitoring ceased&quot;
</pre>
<p>
Note that we have not implemented the ability to pick up on the new
filename after a rename. Calling path will always return the filename you
originally used.
</p>
					

					
					<div class="method-source-code"
						id="watch-file-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1263</span>
1263:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">watch_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>)
1264:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">FileWatch</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
1265: 
1266:     <span class="ruby-identifier">s</span> = <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">watch_filename</span>(<span class="ruby-identifier">filename</span>)
1267:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
1268:     <span class="ruby-comment cmt"># we have to set the path like this because of how Connection.new works</span>
1269:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@path&quot;</span>, <span class="ruby-identifier">filename</span>)
1270:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
1271:     <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span>
1272:     <span class="ruby-identifier">c</span>
1273:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="watch-process-method" class="method-detail ">
				<a name="M000263"></a>

				<div class="method-heading">
				
					<span class="method-name">watch_process</span><span
						class="method-args">(pid, handler=nil, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
EventMachine&#8217;s process monitoring API. Currently supported using
kqueue for OSX/BSD.
</p>
<h3>Usage example:</h3>
<pre>
 module ProcessWatcher
   def process_exited
     put 'the forked child died!'
   end
 end

 pid = fork{ sleep }

 EM.run{
   EM.watch_process(pid, ProcessWatcher)
   EM.add_timer(1){ Process.kill('TERM', pid) }
 }</pre>
					

					
					<div class="method-source-code"
						id="watch-process-source">
<pre>
      <span class="ruby-comment cmt"># File lib/eventmachine.rb, line 1292</span>
1292:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">watch_process</span>(<span class="ruby-identifier">pid</span>, <span class="ruby-identifier">handler</span>=<span class="ruby-keyword kw">nil</span>, *<span class="ruby-identifier">args</span>)
1293:     <span class="ruby-identifier">pid</span> = <span class="ruby-identifier">pid</span>.<span class="ruby-identifier">to_i</span>
1294: 
1295:     <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">klass_from_handler</span>(<span class="ruby-constant">ProcessWatch</span>, <span class="ruby-identifier">handler</span>, *<span class="ruby-identifier">args</span>)
1296: 
1297:     <span class="ruby-identifier">s</span> = <span class="ruby-constant">EM</span><span class="ruby-operator">::</span><span class="ruby-identifier">watch_pid</span>(<span class="ruby-identifier">pid</span>)
1298:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">s</span>, *<span class="ruby-identifier">args</span>
1299:     <span class="ruby-comment cmt"># we have to set the path like this because of how Connection.new works</span>
1300:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@pid&quot;</span>, <span class="ruby-identifier">pid</span>)
1301:     <span class="ruby-ivar">@conns</span>[<span class="ruby-identifier">s</span>] = <span class="ruby-identifier">c</span>
1302:     <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span>
1303:     <span class="ruby-identifier">c</span>
1304:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

